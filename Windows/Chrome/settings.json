{
  "userStyles": {},
  "userPlugins": {},
  "userComponents": {
    "badgeHelper": {
      "code": "!function(e,n){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define([],n):\"object\"==typeof exports?exports[\"live/badge-helper\"]=n():e[\"live/badge-helper\"]=n()}(globalThis,(()=>(()=>{var e,n,t={341:(e,n,t)=>{\"use strict\";t.d(n,{QF:()=>p,hE:()=>s,SL:()=>c,xn:()=>u});const l=coreApis.ajax;var o=t(847);const a=coreApis.utils.log;function i(e,n,t){return(n=function(e){var n=function(e,n){if(\"object\"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var l=t.call(e,n||\"default\");if(\"object\"!=typeof l)return l;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===n?String:Number)(e)}(e,\"string\");return\"symbol\"==typeof n?n:n+\"\"}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const r=(e,n)=>{if(0!==e.code){const t=`${n} 错误码:${e.code} ${e.message||\"\"}`;return(0,a.logError)(t),!1}return!0};class d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isActive=e,this.id=n}}class p extends d{constructor(e){const{medal:{medal_id:n,level:t,medal_name:l,wearing_status:o,is_lighted:a},anchor_info:{nick_name:r},room_info:{room_id:d}}=e;super(1===o,n),i(this,\"level\",void 0),i(this,\"name\",void 0),i(this,\"upName\",void 0),i(this,\"roomID\",void 0),i(this,\"isLighted\",void 0),this.level=t,this.name=l,this.upName=r,this.roomID=d,this.isLighted=a}async activate(){const e=await(0,l.postTextWithCredentials)(\"https://api.live.bilibili.com/xlive/web-room/v1/fansMedal/wear\",new URLSearchParams({medal_id:this.id.toString(),csrf_token:(0,o.getCsrf)(),csrf:(0,o.getCsrf)()})),n=r(JSON.parse(e),\"佩戴勋章失败.\");return this.isActive=!0,n}async deactivate(){const e=await(0,l.postTextWithCredentials)(\"https://api.live.bilibili.com/xlive/web-room/v1/fansMedal/take_off\",new URLSearchParams({csrf_token:(0,o.getCsrf)(),csrf:(0,o.getCsrf)()})),n=r(JSON.parse(e),\"卸下勋章失败.\");return this.isActive=!1,n}}const c=async()=>(await(0,l.getPages)({api:e=>(0,l.getJsonWithCredentials)(`https://api.live.bilibili.com/xlive/app-ucenter/v1/fansMedal/panel?page=${e}&page_size=50`),getList:e=>(r(e,\"无法获取勋章列表.\"),[...lodash.get(e,\"data.list\",[]),...lodash.get(e,\"data.special_list\",[])]),getTotal:e=>lodash.get(e,\"data.total_number\",0)})).map((e=>new p(e)));class s extends d{constructor(e){const{identification:n,wear:t,tid:l,cid:o,name:a,source:r}=e;super(t,n),i(this,\"tid\",void 0),i(this,\"cid\",void 0),i(this,\"name\",void 0),i(this,\"source\",void 0),i(this,\"imageUrl\",void 0),this.tid=l,this.cid=o,this.name=a,this.source=r,s.getImageMap().then((e=>{this.imageUrl=e[this.id]}))}static async getImageMap(){if(void 0===s.imageMap){const e=JSON.parse(await(0,l.getTextWithCredentials)(\"https://api.live.bilibili.com/rc/v1/Title/webTitles\"));return r(e,\"获取头衔图片失败.\")?(s.imageMap={},e.data.forEach((e=>{s.imageMap[e.identification]=e.web_pic_url})),s.imageMap):{}}return s.imageMap}async activate(){const e=JSON.parse(await(0,l.postTextWithCredentials)(\"https://api.live.bilibili.com/i/ajaxWearTitle\",`id=${this.tid}&cid=${this.cid}&csrf=${(0,o.getCsrf)()}&csrf_token=${(0,o.getCsrf)()}`));return!!r(e,\"佩戴头衔失败.\")&&(this.isActive=!0,!0)}async deactivate(){const e=JSON.parse(await(0,l.postTextWithCredentials)(\"https://api.live.bilibili.com/i/ajaxCancelWearTitle\",`csrf=${(0,o.getCsrf)()}&csrf_token=${(0,o.getCsrf)()}`));return!!r(e,\"卸下头衔失败.\")&&(this.isActive=!1,!0)}}i(s,\"imageMap\",void 0);const u=async()=>{const e=JSON.parse(await(0,l.getTextWithCredentials)(\"https://api.live.bilibili.com/xlive/web-ucenter/v1/user_title/TitleList?normal=0&special=0&had=1&page=1&page_size=256\"));return r(e,\"无法获取头衔列表.\")?lodash.get(e,\"data.list\",[]).map((e=>new s(e))):[]}},278:(e,n,t)=>{var l=t(955)((function(e){return e[1]}));l.push([e.id,\".badge-popup {\\n  top: 50%;\\n  left: calc(100% + 8px);\\n  transform: scale(0.9) translateY(-50%);\\n  transform-origin: left;\\n  padding: 4px;\\n  max-height: calc(100vh - 150px);\\n  background-color: #fff;\\n  color: black;\\n  border-radius: 8px;\\n  border: 1px solid #8882;\\n  box-sizing: border-box;\\n  box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.05);\\n  overflow: auto;\\n  scrollbar-width: none !important;\\n  overscroll-behavior: contain;\\n  border-radius: 4px;\\n}\\nbody.dark .badge-popup {\\n  box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.2);\\n}\\nbody.dark .badge-popup {\\n  background-color: #282828;\\n  color: #eee;\\n}\\n.badge-popup::-webkit-scrollbar {\\n  height: 0 !important;\\n  width: 0 !important;\\n}\\n.badge-popup.open {\\n  transform: scale(1) translateY(-50%);\\n}\\nbody.settings-panel-dock-right .badge-popup {\\n  right: calc(100% + 8px);\\n  left: unset;\\n  transform-origin: right;\\n}\\n.badge-popup, .badge-popup * {\\n  transition: 0.2s ease-out;\\n}\\n.badge-popup ul {\\n  list-style: none;\\n  margin: 0;\\n  padding: 0;\\n  display: grid;\\n  grid-template-columns: repeat(2, 1fr);\\n}\\n.badge-popup ul li {\\n  border-radius: 4px;\\n  cursor: pointer;\\n  padding: 6px 8px;\\n  display: flex;\\n  justify-content: center;\\n}\\n.badge-popup ul li:hover {\\n  background-color: #8882;\\n}\\n.badge-popup ul li.active {\\n  box-shadow: 0 0 0px 1px var(--theme-color), 0 0 0px 3px var(--theme-color-20);\\n}\\n.badge-popup ul li.gray:not(:hover) {\\n  filter: grayscale(1);\\n}\\n.badge-popup ul li .title-image {\\n  display: inline-block;\\n  vertical-align: middle;\\n  height: 20px;\\n}\\n.badge-popup ul li .fans-medal-item {\\n  display: flex !important;\\n  height: 14px;\\n  line-height: 14px;\\n  color: #fff;\\n  border: 1px solid #f6be18;\\n  background-color: #f6be18;\\n  border-left: 0;\\n  white-space: nowrap;\\n  border-radius: 2px;\\n  flex-shrink: 0;\\n  font-size: 12px;\\n}\\n.badge-popup ul li .fans-medal-item .label {\\n  width: 40px;\\n  text-align: center;\\n  padding: 0 2px;\\n  color: #fff;\\n  border-radius: 1px 0 0 1px;\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .fans-medal-item .level {\\n  width: 16px;\\n  background-color: #fff;\\n  text-align: center;\\n  color: #f6be18;\\n  border-radius: 0 1px 1px 0;\\n}\\n.badge-popup ul li .fans-medal-item .label,\\n.badge-popup ul li .fans-medal-item .level {\\n  cursor: pointer;\\n  position: relative;\\n  display: block;\\n  float: left;\\n}\\n.badge-popup ul li .level-1 {\\n  border-color: #48b6a5;\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-1 .label {\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-1 .level {\\n  color: #48b6a5;\\n}\\n.badge-popup ul li .level-2 {\\n  border-color: #48b6a5;\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-2 .label {\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-2 .level {\\n  color: #48b6a5;\\n}\\n.badge-popup ul li .level-3 {\\n  border-color: #48b6a5;\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-3 .label {\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-3 .level {\\n  color: #48b6a5;\\n}\\n.badge-popup ul li .level-4 {\\n  border-color: #48b6a5;\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-4 .label {\\n  background-color: #48b6a5;\\n}\\n.badge-popup ul li .level-4 .level {\\n  color: #48b6a5;\\n}\\n.badge-popup ul li .level-5 {\\n  border-color: #5896de;\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-5 .label {\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-5 .level {\\n  color: #5896de;\\n}\\n.badge-popup ul li .level-6 {\\n  border-color: #5896de;\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-6 .label {\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-6 .level {\\n  color: #5896de;\\n}\\n.badge-popup ul li .level-7 {\\n  border-color: #5896de;\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-7 .label {\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-7 .level {\\n  color: #5896de;\\n}\\n.badge-popup ul li .level-8 {\\n  border-color: #5896de;\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-8 .label {\\n  background-color: #5896de;\\n}\\n.badge-popup ul li .level-8 .level {\\n  color: #5896de;\\n}\\n.badge-popup ul li .level-9 {\\n  border-color: #a068f1;\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-9 .label {\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-9 .level {\\n  color: #a068f1;\\n}\\n.badge-popup ul li .level-10 {\\n  border-color: #a068f1;\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-10 .label {\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-10 .level {\\n  color: #a068f1;\\n}\\n.badge-popup ul li .level-11 {\\n  border-color: #a068f1;\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-11 .label {\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-11 .level {\\n  color: #a068f1;\\n}\\n.badge-popup ul li .level-12 {\\n  border-color: #a068f1;\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-12 .label {\\n  background-color: #a068f1;\\n}\\n.badge-popup ul li .level-12 .level {\\n  color: #a068f1;\\n}\\n.badge-popup ul li .level-13 {\\n  border-color: #ff86b2;\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-13 .label {\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-13 .level {\\n  color: #ff86b2;\\n}\\n.badge-popup ul li .level-14 {\\n  border-color: #ff86b2;\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-14 .label {\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-14 .level {\\n  color: #ff86b2;\\n}\\n.badge-popup ul li .level-15 {\\n  border-color: #ff86b2;\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-15 .label {\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-15 .level {\\n  color: #ff86b2;\\n}\\n.badge-popup ul li .level-16 {\\n  border-color: #ff86b2;\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-16 .label {\\n  background-color: #ff86b2;\\n}\\n.badge-popup ul li .level-16 .level {\\n  color: #ff86b2;\\n}\\n.badge-popup ul li .level-17 {\\n  border-color: #f6be18;\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-17 .label {\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-17 .level {\\n  color: #f6be18;\\n}\\n.badge-popup ul li .level-18 {\\n  border-color: #f6be18;\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-18 .label {\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-18 .level {\\n  color: #f6be18;\\n}\\n.badge-popup ul li .level-19 {\\n  border-color: #f6be18;\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-19 .label {\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-19 .level {\\n  color: #f6be18;\\n}\\n.badge-popup ul li .level-20 {\\n  border-color: #f6be18;\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-20 .label {\\n  background-color: #f6be18;\\n}\\n.badge-popup ul li .level-20 .level {\\n  color: #f6be18;\\n}\\n.badge-popup.medal ul {\\n  grid-template-columns: repeat(var(--medal-columns, 2), 1fr);\\n}\\n.badge-popup.title ul {\\n  grid-template-columns: repeat(var(--title-columns, 2), 1fr);\\n}\",\"\"]),e.exports=l},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=e(n);return n[2]?\"@media \".concat(n[2],\" {\").concat(t,\"}\"):t})).join(\"\")},\n// eslint-disable-next-line func-names\nn.i=function(e,t,l){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var o={};if(l)for(var a=0;a<this.length;a++){\n// eslint-disable-next-line prefer-destructuring\nvar i=this[a][0];null!=i&&(o[i]=!0)}for(var r=0;r<e.length;r++){var d=[].concat(e[r]);l&&o[d[0]]||(t&&(d[2]?d[2]=\"\".concat(t,\" and \").concat(d[2]):d[2]=t),n.push(d))}},n}},991:(e,n,t)=>{\"use strict\";var l,o=function(){return void 0===l&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\nl=Boolean(window&&document&&document.all&&!window.atob)),l},a=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),i=[];function r(e){for(var n=-1,t=0;t<i.length;t++)if(i[t].identifier===e){n=t;break}return n}function d(e,n){for(var t={},l=[],o=0;o<e.length;o++){var a=e[o],d=n.base?a[0]+n.base:a[0],p=t[d]||0,c=\"\".concat(d,\" \").concat(p);t[d]=p+1;var s=r(c),u={css:a[1],media:a[2],sourceMap:a[3]};-1!==s?(i[s].references++,i[s].updater(u)):i.push({identifier:c,updater:v(u,n),references:1}),l.push(c)}return l}function p(e){var n=document.createElement(\"style\"),l=e.attributes||{};if(void 0===l.nonce){var o=t.nc;o&&(l.nonce=o)}if(Object.keys(l).forEach((function(e){n.setAttribute(e,l[e])})),\"function\"==typeof e.insert)e.insert(n);else{var i=a(e.insert||\"head\");if(!i)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");i.appendChild(n)}return n}var c,s=(c=[],function(e,n){return c[e]=n,c.filter(Boolean).join(\"\\n\")});function u(e,n,t,l){var o=t?\"\":l.media?\"@media \".concat(l.media,\" {\").concat(l.css,\"}\"):l.css;if(e.styleSheet)e.styleSheet.cssText=s(n,o);else{var a=document.createTextNode(o),i=e.childNodes;i[n]&&e.removeChild(i[n]),i.length?e.insertBefore(a,i[n]):e.appendChild(a)}}function b(e,n,t){var l=t.css,o=t.media,a=t.sourceMap;if(o?e.setAttribute(\"media\",o):e.removeAttribute(\"media\"),a&&\"undefined\"!=typeof btoa&&(l+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a)))),\" */\")),e.styleSheet)e.styleSheet.cssText=l;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(l))}}var f=null,g=0;function v(e,n){var t,l,o;if(n.singleton){var a=g++;t=f||(f=p(n)),l=u.bind(null,t,a,!1),o=u.bind(null,t,a,!0)}else t=p(n),l=b.bind(null,t,n),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return l(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;l(e=n)}else o()}}e.exports=function(e,n){(n=n||{}).singleton||\"boolean\"==typeof n.singleton||(n.singleton=o());var t=d(e=e||[],n);return function(e){if(e=e||[],\"[object Array]\"===Object.prototype.toString.call(e)){for(var l=0;l<t.length;l++){var o=r(t[l]);i[o].references--}for(var a=d(e,n),p=0;p<t.length;p++){var c=r(t[p]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}t=a}}}},601:(e,n,t)=>{\"use strict\";t.r(n),t.d(n,{default:()=>m});var l=function(){var e=this,n=e._self._c,t=e._self._setupProxy;return n(\"div\",{ref:\"element\",staticClass:\"multiple-widgets\"},[n(t.VPopup,{ref:\"medalPopup\",staticClass:\"badge-popup widgets-popup medal\",attrs:{\"trigger-element\":e.$refs.medalButton},model:{value:t.medalOpen,callback:function(e){t.medalOpen=e},expression:\"medalOpen\"}},[n(\"ul\",e._l(t.medalList,(function(l){return n(\"li\",{key:l.id,class:{active:l.isActive,gray:t.grayEffect&&!l.isLighted},attrs:{\"data-id\":l.id,title:l.upName},on:{click:function(e){return t.toggleBadge(l,t.medalList)}}},[n(\"div\",{staticClass:\"fans-medal-item\",class:[\"level-\"+l.level]},[n(\"span\",{staticClass:\"label\"},[e._v(e._s(l.name))]),e._v(\" \"),n(\"span\",{staticClass:\"level\"},[e._v(e._s(l.level))])])])})),0)]),e._v(\" \"),n(t.DefaultWidget,{ref:\"medalButton\",attrs:{icon:\"mdi-medal\"},on:{click:function(e){t.medalOpen=!t.medalOpen}}},[n(\"span\",[e._v(\"更换勋章\")])]),e._v(\" \"),n(t.VPopup,{ref:\"titlePopup\",staticClass:\"badge-popup widgets-popup title\",attrs:{\"trigger-element\":e.$refs.titleButton},model:{value:t.titleOpen,callback:function(e){t.titleOpen=e},expression:\"titleOpen\"}},[n(\"ul\",e._l(t.titleList,(function(e){return n(\"li\",{key:e.id,class:{active:e.isActive},attrs:{\"data-id\":e.id},on:{click:function(n){return t.toggleBadge(e,t.titleList)}}},[n(\"img\",{staticClass:\"title-image\",attrs:{src:e.imageUrl}})])})),0)]),e._v(\" \"),n(t.DefaultWidget,{ref:\"titleButton\",attrs:{icon:\"mdi-script-outline\"},on:{click:function(e){t.titleOpen=!t.titleOpen}}},[n(\"span\",[e._v(\"更换头衔\")])])],1)};l._withStripped=!0;const o=globalThis.Vue;var a=t(905);const i=coreApis.utils.sort,r=coreApis.ui;var d=t(341);const p=(0,o.defineComponent)({__name:\"BadgeHelper\",setup(e){const{options:n}=(0,a.getComponentSettings)(\"badgeHelper\"),t=(0,o.ref)(),l=(0,o.ref)([]),p=(0,o.ref)([]),c=(0,o.ref)(!1),s=(0,o.ref)(!1),u=(0,o.ref)(!0),b=()=>{const e=Math.min(Math.ceil(l.value.length/18),15);t.value.style.setProperty(\"--medal-columns\",e.toString());const n=Math.min(Math.ceil(p.value.length/18),15);t.value.style.setProperty(\"--title-columns\",n.toString())},f=async()=>{l.value=(await(0,d.SL)()).sort((0,i.descendingSort)((e=>e.level))).slice(0,n.maxBadgeCount)},g=async()=>{p.value=(await(0,d.xn)()).slice(0,n.maxBadgeCount)};return(0,o.onMounted)((async()=>{(0,a.addComponentListener)(\"badgeHelper.grayEffect\",(e=>{u.value=e}),!0);await(async()=>{const e=f();await d.hE.getImageMap();const n=g();return Promise.all([e,n])})(),b()})),{__sfc:!0,options:n,element:t,medalList:l,titleList:p,medalOpen:c,titleOpen:s,grayEffect:u,updateColumnsCount:b,loadMedalList:f,loadTitleList:g,toggleBadge:async(e,t)=>{if(console.log(e),e.isActive)e.isActive=!1,await e.deactivate();else{const l=t.find((e=>e.isActive));l&&(l.isActive=!1),e.isActive=!0,await e.activate(),e instanceof d.QF&&(n.defaultMedalID=e.id)}e instanceof d.QF?await f():e instanceof d.hE&&await g()},DefaultWidget:r.DefaultWidget,VPopup:r.VPopup}}}),c=p;var s=t(991),u=t.n(s),b=t(278),f=t.n(b),g={insert:\"head\",singleton:!1};u()(f(),g);f().locals;var v=function(e,n,t,l,o,a,i,r){var d,p=\"function\"==typeof e?e.options:e;if(n&&(p.render=n,p.staticRenderFns=t,p._compiled=!0),l&&(p.functional=!0),a&&(p._scopeId=\"data-v-\"+a),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},p._ssrRegister=d):o&&(d=r?function(){o.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:o),d)if(p.functional){p._injectStyles=d;var c=p.render;p.render=function(e,n){return d.call(n),c(e,n)}}else{var s=p.beforeCreate;p.beforeCreate=s?[].concat(s,d):[d]}return{exports:e,options:p}}(c,l,[],!1,null,null,null);const m=v.exports},651:e=>{function n(e){var n=new Error(\"Cannot find module '\"+e+\"'\");throw n.code=\"MODULE_NOT_FOUND\",n}n.keys=()=>[],n.resolve=n,n.id=651,e.exports=n},700:e=>{\"use strict\";e.exports=\"在直播区中, 可从功能面板中直接切换勋章和头衔. 默认显示 256 个 (同时也是上限), 可在选项中修改.\\n\"},905:e=>{\"use strict\";e.exports=coreApis.settings},847:e=>{\"use strict\";e.exports=coreApis.utils}},l={};function o(e){var n=l[e];if(void 0!==n)return n.exports;var a=l[e]={id:e,exports:{}};return t[e](a,a.exports,o),a.exports}o.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return o.d(n,{a:n}),n},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(t,l){if(1&l&&(t=this(t)),8&l)return t;if(\"object\"==typeof t&&t){if(4&l&&t.__esModule)return t;if(16&l&&\"function\"==typeof t.then)return t}var a=Object.create(null);o.r(a);var i={};e=e||[null,n({}),n([]),n(n)];for(var r=2&l&&t;\"object\"==typeof r&&!~e.indexOf(r);r=n(r))Object.getOwnPropertyNames(r).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,o.d(a,i),a},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.nc=void 0;var a={};return(()=>{\"use strict\";o.d(a,{component:()=>i});const e=coreApis.componentApis.define;var n=o(847),t=o(341);const l=(0,e.defineOptionsMetadata)({autoMatchMedal:{defaultValue:!0,displayName:\"自动佩戴当前直播间勋章\"},maxBadgeCount:{defaultValue:256,displayName:\"最大显示数量\",validator:(0,n.getNumberValidator)(1,256)},defaultMedalID:{displayName:\"默认勋章ID\",hidden:!0,defaultValue:0},grayEffect:{displayName:\"显示勋章的未点亮状态\",defaultValue:!0}}),i=(0,e.defineComponentMetadata)({name:\"badgeHelper\",displayName:\"直播勋章快速更换\",entry:()=>(async()=>{const{getUID:e}=await Promise.resolve().then(o.t.bind(o,847,23));if(!e())return;const{getComponentSettings:n}=await Promise.resolve().then(o.t.bind(o,905,23)),{options:l}=n(\"badgeHelper\");if(!l.autoMatchMedal)return;const a=document.URL.match(/^https:\\/\\/live\\.bilibili\\.com\\/(blanc\\/)?([\\d]+)/);if(!a)return;const i=parseInt(a[2]);if(Number.isNaN(i))return void console.warn(\"roomID not found\");const r=await(0,t.SL)();if(!l.defaultMedalID){const e=r.find((e=>e.isActive));e&&(l.defaultMedalID=e.id,console.log(`set defaultMedalID to activeMedal (${e.id})`))}const d=l.defaultMedalID?r.find((e=>e.id===l.defaultMedalID)):r.find((e=>e.isActive)),p=r.find((e=>e.roomID===i));p?(await p.activate(),console.log(`activated matchMedal (${p.id})`)):d&&(await d.activate(),console.log(`no matchMedal, fallback to defaultMedal (${d.id})`))})(),reload:n.none,unload:n.none,tags:[componentsTags.live],widget:{component:()=>Promise.resolve().then(o.bind(o,601)).then((e=>e.default)),condition:()=>Boolean((0,n.getUID)())},options:l,urlInclude:[\"//live.bilibili.com\"],commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\",description:(()=>{const e=o(651);return{...Object.fromEntries(e.keys().map((n=>[n.match(/index\\.(.+)\\.md$/)[1],e(n)]))),\"zh-CN\":()=>Promise.resolve().then(o.t.bind(o,700,17)).then((e=>e.default))}})()})})(),a=a.component})()));",
      "metadata": {
        "name": "badgeHelper",
        "displayName": "直播勋章快速更换",
        "tags": [
          {
            "name": "live",
            "displayName": "直播",
            "color": "#26A69A",
            "icon": "mdi-video-wireless-outline",
            "order": 4
          }
        ],
        "options": {
          "autoMatchMedal": {
            "defaultValue": true,
            "displayName": "自动佩戴当前直播间勋章"
          },
          "maxBadgeCount": {
            "defaultValue": 256,
            "displayName": "最大显示数量"
          },
          "defaultMedalID": {
            "displayName": "默认勋章ID",
            "hidden": true,
            "defaultValue": 0
          },
          "grayEffect": {
            "displayName": "显示勋章的未点亮状态",
            "defaultValue": true
          }
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1",
        "description": {}
      },
      "settings": {
        "enabled": true,
        "options": {
          "autoMatchMedal": true,
          "maxBadgeCount": 256,
          "defaultMedalID": 31047,
          "grayEffect": true
        }
      }
    },
    "autoHideSidebar": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"style/auto-hide-sidebar\"]=t():e[\"style/auto-hide-sidebar\"]=t()}(globalThis,(()=>(()=>{var e,t,o={847:(e,t,o)=>{var n=o(955)((function(e){return e[1]}));n.push([e.id,'body .be-settings::before {\\n  content: \"\";\\n  position: fixed;\\n  width: var(--auto-hide-sidebar-width, 8px);\\n  height: 100vh;\\n  top: 0;\\n  left: 0;\\n}\\nbody .be-settings > .sidebar {\\n  transition: transform 0.2s ease-out;\\n}\\nbody .be-settings:not(:hover) > .sidebar {\\n  transform: translateX(calc(-100% * var(--direction))) translateY(-50%);\\n}\\nbody.settings-panel-dock-right .be-settings::before {\\n  left: unset;\\n  right: 0;\\n}',\"\"]),e.exports=n},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o=e(t);return t[2]?\"@media \".concat(t[2],\" {\").concat(o,\"}\"):o})).join(\"\")},\n// eslint-disable-next-line func-names\nt.i=function(e,o,n){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var r={};if(n)for(var i=0;i<this.length;i++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[i][0];null!=a&&(r[a]=!0)}for(var s=0;s<e.length;s++){var d=[].concat(e[s]);n&&r[d[0]]||(o&&(d[2]?d[2]=\"\".concat(o,\" and \").concat(d[2]):d[2]=o),t.push(d))}},t}},957:(e,t,o)=>{var n=o(847);n&&n.__esModule&&(n=n.default),e.exports=\"string\"==typeof n?n:n.toString()}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={id:e,exports:{}};return o[e](i,i.exports,r),i.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if(\"object\"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&\"function\"==typeof o.then)return o}var i=Object.create(null);r.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&o;\"object\"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>o[e]));return a.default=()=>o,r.d(i,a),i},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};return(()=>{\"use strict\";r.d(i,{component:()=>n});const e=coreApis.componentApis.define,t=coreApis.settings,o=coreApis.utils,n=(0,e.defineComponentMetadata)({name:\"autoHideSidebar\",entry:()=>{(0,t.addComponentListener)(\"autoHideSidebar.triggerWidth\",(e=>{document.documentElement.style.setProperty(\"--auto-hide-sidebar-width\",`${e}px`)}),!0)},displayName:\"自动隐藏侧栏\",instantStyles:[{name:\"autoHideSidebar\",style:()=>Promise.resolve().then(r.t.bind(r,957,23)),important:!0}],tags:[componentsTags.style,componentsTags.general],options:{triggerWidth:{defaultValue:8,displayName:\"触发区域宽度 (px)\",validator:(0,o.getNumberValidator)(1,1e3)}},description:{\"zh-CN\":\"自动隐藏脚本的侧栏 (功能和设置图标). 设置面板停靠在右侧时不建议使用, 因为网页的滚动条会占用右边缘的触发区域.\"},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"})})(),i=i.component})()));",
      "metadata": {
        "name": "autoHideSidebar",
        "displayName": "自动隐藏侧栏",
        "tags": [
          {
            "name": "style",
            "displayName": "样式",
            "color": "#8BC34A",
            "icon": "mdi-palette-outline",
            "order": 2
          },
          {
            "name": "general",
            "displayName": "通用",
            "color": "#888",
            "icon": "mdi-progress-wrench",
            "order": 8
          }
        ],
        "options": {
          "triggerWidth": {
            "defaultValue": 8,
            "displayName": "触发区域宽度 (px)"
          }
        },
        "description": {
          "zh-CN": "自动隐藏脚本的侧栏 (功能和设置图标). 设置面板停靠在右侧时不建议使用, 因为网页的滚动条会占用右边缘的触发区域."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {
          "triggerWidth": 8
        }
      }
    },
    "downloadAudio": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"utils/download-audio\"]=t():e[\"utils/download-audio\"]=t()}(globalThis,(()=>(()=>{\"use strict\";var e,t,o={379:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"DefaultWidget\",{attrs:{disabled:e.disabled||e.downloading,name:e.progress||\"下载音频\",icon:\"mdi-download\"},on:{click:function(t){return e.download()}}})};n._withStripped=!0;const r=coreApis.spinQuery,i=coreApis.observer,s=coreApis.download,a=coreApis.ui;function d(e,t,o){return(t=function(e){var t=function(e,t){if(\"object\"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"==typeof t?t:t+\"\"}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class l{constructor(){d(this,\"progress\",null),d(this,\"sid\",void 0)}async getDownloadUrl(){const{getJsonWithCredentials:e}=await Promise.resolve().then(o.t.bind(o,416,23)),{Toast:t}=await Promise.resolve().then(o.t.bind(o,5,23)),n=`https://www.bilibili.com/audio/music-service-c/web/url?sid=${this.sid}&privilege=2&quality=2`,r=await e(n);return 0!==r.code?(t.error(\"获取下载链接失败, 请确保当前账号有下载权限.\",\"下载音频\",1e4),null):r.data.cdns.shift()}async download(){const e=await this.getDownloadUrl();return new Promise(((t,o)=>{const n=new XMLHttpRequest;n.open(\"GET\",e),n.responseType=\"blob\",n.addEventListener(\"load\",(()=>t(n.response))),n.addEventListener(\"error\",(()=>o(n.status))),n.addEventListener(\"progress\",(e=>this.progress?.(100*e.loaded/e.total))),n.send()}))}}var c=function(e,t,o,n,r,i,s,a){var d,l=\"function\"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=o,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId=\"data-v-\"+i),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=d):r&&(d=a?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),d)if(l.functional){l._injectStyles=d;var c=l.render;l.render=function(e,t){return d.call(t),c(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,d):[d]}return{exports:e,options:l}}(Vue.extend({components:{DefaultWidget:a.DefaultWidget},data:()=>({progress:\"\",disabled:!0,downloader:new l,downloading:!1}),async mounted(){const e=await(0,r.select)(\"#app\"),t=this.downloader;t.progress=e=>{this.progress=`${Math.round(e)}%`},(0,i.childList)(e,(()=>{const e=document.URL.match(/bilibili\\.com\\/audio\\/au([\\d]+)/);e&&e[1]?(this.disabled=!1,[,t.sid]=e):this.disabled=!0}))},methods:{async download(){if(!this.downloading){this.downloading=!0;try{const e=this.downloader;if(null===e.sid)return;const t=await e.download(),o=`${(()=>{const e=document.querySelector(\".song-title\");return e?e.getAttribute(\"title\"):\"神秘音频\"})()}.mp3`;this.progress=\"\",await s.DownloadPackage.single(o,t)}finally{this.downloading=!1}}}}}),n,[],!1,null,null,null);const u=c.exports},416:e=>{e.exports=coreApis.ajax},5:e=>{e.exports=coreApis.toast}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return o[e](i,i.exports,r),i.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if(\"object\"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&\"function\"==typeof o.then)return o}var i=Object.create(null);r.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&o;\"object\"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>o[e]));return s.default=()=>o,r.d(i,s),i},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};r.d(i,{component:()=>s});const s=(0,coreApis.componentApis.define.defineComponentMetadata)({name:\"downloadAudio\",displayName:\"下载音频\",entry:none,tags:[componentsTags.utils],description:{\"zh-CN\":\"\\n开启音频下载支持, 音频页面中可以在功能面板中下载当前音频.\\n\\n> 需要进入音频的详细信息页面才能下载, 在其他页面中此按钮将不可点击.\\n    \".trim()},widget:{component:()=>Promise.resolve().then(r.bind(r,379)).then((e=>e.default))},urlInclude:[\"//www.bilibili.com/audio/\"],commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"});return i=i.component})()));",
      "metadata": {
        "name": "downloadAudio",
        "displayName": "下载音频",
        "tags": [
          {
            "name": "utils",
            "displayName": "工具",
            "color": "#A36FFD",
            "icon": "mdi-rocket-launch-outline",
            "order": 5
          }
        ],
        "description": {
          "zh-CN": "开启音频下载支持, 音频页面中可以在功能面板中下载当前音频.\n\n> 需要进入音频的详细信息页面才能下载, 在其他页面中此按钮将不可点击."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "viewCover": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"utils/view-cover\"]=t():e[\"utils/view-cover\"]=t()}(globalThis,(()=>(()=>{var e={271:(e,t,n)=>{var o=n(955)((function(e){return e[1]}));o.push([e.id,\".download-cover-config.download-video-config-section .be-dropdown {\\n  text-transform: uppercase;\\n}\",\"\"]),e.exports=o},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?\"@media \".concat(t[2],\" {\").concat(n,\"}\"):n})).join(\"\")},\n// eslint-disable-next-line func-names\nt.i=function(e,n,o){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var i={};if(o)for(var r=0;r<this.length;r++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[r][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);o&&i[c[0]]||(n&&(c[2]?c[2]=\"\".concat(n,\" and \").concat(c[2]):c[2]=n),t.push(c))}},t}},991:(e,t,n)=>{\"use strict\";var o,i=function(){return void 0===o&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\no=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function s(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},o=[],i=0;i<e.length;i++){var r=e[i],c=t.base?r[0]+t.base:r[0],d=n[c]||0,l=\"\".concat(c,\" \").concat(d);n[c]=d+1;var u=s(l),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(a[u].references++,a[u].updater(p)):a.push({identifier:l,updater:h(p,t),references:1}),o.push(l)}return o}function d(e){var t=document.createElement(\"style\"),o=e.attributes||{};if(void 0===o.nonce){var i=n.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),\"function\"==typeof e.insert)e.insert(t);else{var a=r(e.insert||\"head\");if(!a)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");a.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join(\"\\n\")});function p(e,t,n,o){var i=n?\"\":o.media?\"@media \".concat(o.media,\" {\").concat(o.css,\"}\"):o.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var r=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function f(e,t,n){var o=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute(\"media\",i):e.removeAttribute(\"media\"),r&&\"undefined\"!=typeof btoa&&(o+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\" */\")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var v=null,m=0;function h(e,t){var n,o,i;if(t.singleton){var r=m++;n=v||(v=d(t)),o=p.bind(null,n,r,!1),i=p.bind(null,n,r,!0)}else n=d(t),o=f.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||\"boolean\"==typeof t.singleton||(t.singleton=i());var n=c(e=e||[],t);return function(e){if(e=e||[],\"[object Array]\"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var i=s(n[o]);a[i].references--}for(var r=c(e,t),d=0;d<n.length;d++){var l=s(n[d]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}n=r}}}},177:(e,t,n)=>{\"use strict\";n.r(t),n.d(t,{default:()=>f});var o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"download-cover-config download-video-config-section\"},[t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"封面:\")]),e._v(\" \"),t(\"VDropdown\",{attrs:{items:e.items},scopedSlots:e._u([{key:\"item\",fn:function({item:t}){return[e._v(\"\\n        \"+e._s(t)+\"\\n      \")]}}]),model:{value:e.type,callback:function(t){e.type=t},expression:\"type\"}})],1)])};o._withStripped=!0;const i=coreApis.settings;var r=n(164);const{options:a}=(0,i.getComponentSettings)(\"downloadVideo\"),s=Vue.extend({components:{VDropdown:r.VDropdown},data:()=>({type:a.CoverType??\"无\",items:[\"无\",\"jpg\"]}),computed:{enabled(){return\"无\"!==this.type}},watch:{type(e){a.CoverType=e}}});var c=n(991),d=n.n(c),l=n(271),u=n.n(l),p={insert:\"head\",singleton:!1};d()(u(),p);u().locals;const f=(0,n(678).A)(s,o,[],!1,null,null,null).exports},395:(e,t,n)=>{\"use strict\";n.r(t),n.d(t,{default:()=>l});var o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"DefaultWidget\",{staticClass:\"view-cover\",attrs:{disabled:!e.imageUrl,name:\"查看封面\",icon:\"mdi-image-outline\"},on:{click:function(t){return e.viewCover()}}})};o._withStripped=!0;var i=n(341);const r=coreApis.ajax,a=coreApis.observer,s=coreApis.spinQuery;var c=n(164);const d=Vue.extend({components:{DefaultWidget:c.DefaultWidget},data:()=>({imageUrl:\"\"}),async mounted(){if(document.URL.includes(\"live.bilibili.com\")){const e=\".header-info-ctnr .room-cover, .header-info-ctnr .avatar\",t=await(0,s.select)(e);if(!t)return;const n=t.getAttribute(\"href\").match(/space\\.bilibili\\.com\\/([\\d]+)/);if(n&&n[1]){const e=`https://api.live.bilibili.com/room/v1/Room/getRoomInfoOld?mid=${n[1]}`,t=await(0,r.getJson)(e);this.imageUrl=t.data.cover.replace(\"http:\",\"https:\")}}else(0,a.videoChange)((async()=>{const{aid:e}=unsafeWindow;this.imageUrl=await(0,i.getVideoCoverUrlByAid)(e)}))},methods:{async viewCover(){(0,c.showImage)(this.imageUrl)}}});const l=(0,n(678).A)(d,o,[],!1,null,null,null).exports},678:(e,t,n)=>{\"use strict\";function o(e,t,n,o,i,r,a,s){var c,d=\"function\"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),o&&(d.functional=!0),r&&(d._scopeId=\"data-v-\"+r),a?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=c):i&&(c=s?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(e,t){return c.call(t),l(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:d}}n.d(t,{A:()=>o})},341:e=>{\"use strict\";e.exports=coreApis.componentApis.video.videoCover},164:e=>{\"use strict\";e.exports=coreApis.ui}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.nc=void 0;var o={};return(()=>{\"use strict\";n.d(o,{component:()=>a});const e=coreApis.componentApis.define;var t=n(341);const i=coreApis.utils.urls,r=coreApis.toast,a=(0,e.defineComponentMetadata)({name:\"viewCover\",displayName:\"查看封面\",tags:[componentsTags.utils,componentsTags.video],entry:none,reload:none,unload:none,plugin:{displayName:\"下载视频 - 下载封面支持\",setup:e=>{let{addData:o}=e;o(\"downloadVideo.assets\",(async e=>{e.push({name:\"downloadCover\",displayName:\"下载封面\",getAssets:async(e,n)=>{const{type:o,enabled:i}=n;if(!i)return[];const a=r.Toast.info(\"获取封面中...\",\"下载封面\");let s=0;const c=await Promise.allSettled(e.map((async n=>{const i=await(0,t.getBlobByAid)(n.input.aid);return s++,a.message=`获取封面中... (${s}/${e.length})`,{name:`${n.input.title}.${o}`,data:i}}))),d=c.filter((e=>\"fulfilled\"===e.status)),l=c.filter((e=>\"rejected\"===e.status));return a.message=`获取完成. 成功 ${d.length} 个, 失败 ${l.length} 个.`,d.map((e=>e.value))},getUrls:async(e,n)=>{const{type:o,enabled:i}=n;return i?Promise.all(e.map((async e=>({name:`${e.input.title}.${o}`,url:await(0,t.getVideoCoverUrlByAid)(e.input.aid)})))):[]},component:()=>Promise.resolve().then(n.bind(n,177)).then((e=>e.default))})}))}},widget:{component:()=>Promise.resolve().then(n.bind(n,395)).then((e=>e.default))},description:{\"zh-CN\":\"在视频页面中, 可从功能面板中查看封面.\"},urlInclude:[...i.videoAndBangumiUrls],commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"})})(),o=o.component})()));",
      "metadata": {
        "name": "viewCover",
        "displayName": "查看封面",
        "tags": [
          {
            "name": "utils",
            "displayName": "工具",
            "color": "#A36FFD",
            "icon": "mdi-rocket-launch-outline",
            "order": 5
          },
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "description": {
          "zh-CN": "在视频页面中, 可从功能面板中查看封面."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "downloadDanmaku": {
      "code": "!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports[\"video/danmaku/download\"]=e():t[\"video/danmaku/download\"]=e()}(globalThis,(()=>(()=>{var t={186:(t,e,i)=>{\"use strict\";i.d(e,{getDanmakuSegment:()=>d,getDanmakuView:()=>c});const n=coreApis.runtimeLibrary,o={nested:{DmWebViewReply:{fields:{state:{type:\"int32\",id:1},text:{type:\"string\",id:2},textSide:{type:\"string\",id:3},dmSge:{type:\"DmSegConfig\",id:4},flag:{type:\"DanmakuFlagConfig\",id:5},specialDms:{rule:\"repeated\",type:\"string\",id:6},checkBox:{type:\"bool\",id:7},count:{type:\"int64\",id:8},commandDms:{rule:\"repeated\",type:\"CommandDm\",id:9},dmSetting:{type:\"DanmuWebPlayerConfig\",id:10}}},CommandDm:{fields:{id:{type:\"int64\",id:1},oid:{type:\"int64\",id:2},mid:{type:\"int64\",id:3},command:{type:\"string\",id:4},content:{type:\"string\",id:5},progress:{type:\"int32\",id:6},ctime:{type:\"string\",id:7},mtime:{type:\"string\",id:8},extra:{type:\"string\",id:9},idStr:{type:\"string\",id:10}}},DmSegConfig:{fields:{pageSize:{type:\"int64\",id:1},total:{type:\"int64\",id:2}}},DanmakuFlagConfig:{fields:{recFlag:{type:\"int32\",id:1},recText:{type:\"string\",id:2},recSwitch:{type:\"int32\",id:3}}},DmSegMobileReply:{fields:{elems:{rule:\"repeated\",type:\"DanmakuElem\",id:1}}},DanmakuElem:{fields:{id:{type:\"int64\",id:1},progress:{type:\"int32\",id:2},mode:{type:\"int32\",id:3},fontsize:{type:\"int32\",id:4},color:{type:\"uint32\",id:5},midHash:{type:\"string\",id:6},content:{type:\"string\",id:7},ctime:{type:\"int64\",id:8},weight:{type:\"int32\",id:9},action:{type:\"string\",id:10},pool:{type:\"int32\",id:11},idStr:{type:\"string\",id:12},attr:{type:\"int32\",id:13}}},DanmuWebPlayerConfig:{fields:{dmSwitch:{type:\"bool\",id:1},aiSwitch:{type:\"bool\",id:2},aiLevel:{type:\"int32\",id:3},blocktop:{type:\"bool\",id:4},blockscroll:{type:\"bool\",id:5},blockbottom:{type:\"bool\",id:6},blockcolor:{type:\"bool\",id:7},blockspecial:{type:\"bool\",id:8},preventshade:{type:\"bool\",id:9},dmask:{type:\"bool\",id:10},opacity:{type:\"float\",id:11},dmarea:{type:\"int32\",id:12},speedplus:{type:\"float\",id:13},fontsize:{type:\"float\",id:14},screensync:{type:\"bool\",id:15},speedsync:{type:\"bool\",id:16},fontfamily:{type:\"string\",id:17},bold:{type:\"bool\",id:18},fontborder:{type:\"int32\",id:19},drawType:{type:\"string\",id:20}}}}},r=lodash.curry((async(t,e)=>{const i=new Uint8Array(\"arrayBuffer\"in Blob.prototype?await e.arrayBuffer():await new Response(e).arrayBuffer()),r=(await n.protobufLibrary).Root.fromJSON(o).lookupType(t),a=r.decode(i);return r.toObject(a)})),a=r(\"DmSegMobileReply\"),s=r(\"DmWebViewReply\"),l=async t=>(await unsafeWindow.fetch(t,{mode:\"cors\",credentials:\"include\"})).blob(),c=async(t,e)=>{const i=await l(`https://api.bilibili.com/x/v2/dm/web/view?type=1&oid=${e}&pid=${t}`);if(!i)throw new Error(\"获取弹幕信息失败\");return await s(i)},d=async(t,e,i)=>{const n=await l(`https://api.bilibili.com/x/v2/dm/web/seg.so?type=1&oid=${e}&pid=${t}&segment_index=${i+1}`);if(!n)throw new Error(`弹幕片段${i+1}下载失败`);return a(n)}},202:(t,e,i)=>{\"use strict\";i.d(e,{getBlobByType:()=>P});const n=coreApis.utils.lazyPanel;var o=i(765);const r=coreApis.utils.sort;var a=i(121);const s=coreApis.componentApis.video.assUtils;function l(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c{constructor(t){let{content:e,time:i,type:n,fontSize:o,color:r}=t;l(this,\"content\",void 0),l(this,\"time\",void 0),l(this,\"startTime\",void 0),l(this,\"type\",void 0),l(this,\"fontSize\",void 0),l(this,\"color\",void 0),this.content=e,this.time=i,this.startTime=parseFloat(i),this.type=parseInt(n),this.fontSize=parseFloat(o),this.color=parseInt(r)}}function d(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u extends c{constructor(t){let{content:e,time:i,type:n,fontSize:o,color:r,typeTag:a,colorTag:s,endTime:l}=t;super({content:e,time:i,type:n,fontSize:o,color:r}),d(this,\"typeTag\",void 0),d(this,\"colorTag\",void 0),d(this,\"endTime\",void 0),this.typeTag=a,this.colorTag=s,this.endTime=l}text(t){let e=t[this.fontSize];e||(e=t[25]);const i=e.match(/Style:(.*?),/)[1].trim();return`Dialogue: 0,${this.time},${this.endTime},${i},,0,0,0,,{${this.typeTag}${this.colorTag}}${this.content}`}}class p{constructor(t,e,i,n,o){d(this,\"danmakus\",void 0),d(this,\"title\",void 0),d(this,\"fontStyles\",void 0),d(this,\"blockTypes\",void 0),d(this,\"resolution\",void 0),this.danmakus=t,this.title=e,this.fontStyles=i,this.blockTypes=n,this.resolution=o}generateAss(){return`${`\\n[Script Info]\\n; Script generated by Bilibili Evolved Danmaku Converter\\n; https://github.com/the1812/Bilibili-Evolved/\\nTitle: ${this.title}\\nScriptType: v4.00+\\nPlayResX: ${this.resolution.x}\\nPlayResY: ${this.resolution.y}\\nTimer: 10.0000\\nWrapStyle: 2\\nScaledBorderAndShadow: no\\n\\n[V4+ Styles]\\nFormat: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding\\n${Object.values(this.fontStyles).join(\"\\n\")}\\n\\n[Events]\\nFormat: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text\\n                `.trim()}\\n${this.danmakus.map((t=>t.text(this.fontStyles))).filter((t=>\"\"!==t)).join(\"\\n\")}`}}const m=coreApis.componentApis.video.xmlUtils;function h(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class f extends c{constructor(t){let{content:e,time:i,type:n,fontSize:o,color:r,timeStamp:a,pool:s,userHash:l,rowId:c}=t;super({content:e,time:i,type:n,fontSize:o,color:r}),h(this,\"timeStamp\",void 0),h(this,\"pool\",void 0),h(this,\"userHash\",void 0),h(this,\"rowId\",void 0),h(this,\"pDataArray\",void 0),this.timeStamp=parseInt(a),this.pool=parseInt(s),this.userHash=l,this.rowId=parseInt(c),this.pDataArray=[i,n,o,r,a,s,l,c]}text(){return`<d p=\"${this.pDataArray.join(\",\")}\">${(0,m.escapeContent)(this.content)}</d>`}static parse(t){const e=t.getAttribute(\"p\"),[i,n,o,r,a,s,l,c]=e.split(\",\"),d=t.innerHTML;return new f({content:d,time:i,type:n,fontSize:o,color:r,timeStamp:a,pool:s,userHash:l,rowId:c})}}class y{constructor(t){h(this,\"xml\",void 0),h(this,\"danmakus\",void 0),this.xml=t;const e=(new DOMParser).parseFromString(t,\"application/xml\").documentElement;this.danmakus=[...e.querySelectorAll(\"d[p]\")].map((t=>f.parse(t)))}}const g=coreApis.utils;let v=function(t){return t[t.Normal=1]=\"Normal\",t[t.Normal2=2]=\"Normal2\",t[t.Normal3=3]=\"Normal3\",t[t.Bottom=4]=\"Bottom\",t[t.Top=5]=\"Top\",t[t.Reversed=6]=\"Reversed\",t[t.Special=7]=\"Special\",t[t.Special2=8]=\"Special2\",t}({});function b(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class S{constructor(t,e,i,n){b(this,\"horizontalStack\",void 0),b(this,\"horizontalTrack\",void 0),b(this,\"verticalStack\",void 0),b(this,\"verticalTrack\",void 0),b(this,\"resolution\",void 0),b(this,\"duration\",void 0),b(this,\"canvas\",void 0),b(this,\"context\",void 0),b(this,\"fontSizes\",void 0),b(this,\"bottomMarginPercent\",void 0),b(this,\"danmakuHeight\",void 0),b(this,\"trackHeight\",void 0),b(this,\"trackCount\",void 0),this.horizontalStack=[],this.horizontalTrack=[],this.verticalStack=[],this.verticalTrack=[],this.resolution=e,this.duration=i,this.canvas=document.createElement(\"canvas\"),this.context=this.canvas.getContext(\"2d\"),this.fontSizes={30:`64px ${t}`,25:`52px ${t}`,18:`36px ${t}`,45:`90px ${t}`},this.bottomMarginPercent=n,this.generateTracks()}generateTracks(){this.danmakuHeight=52,this.trackHeight=2*S.margin+52,this.trackCount=parseInt((0,g.fixed)(this.resolution.y*(1-this.bottomMarginPercent)/this.trackHeight,0))}getTextSize(t){this.context.font=this.fontSizes[t.fontSize];return[this.context.measureText(t.content).width/2,this.danmakuHeight/2]}getTags(t,e){let{targetTrack:i,initTrackNumber:n,nextTrackNumber:o,willOverlay:r,getTrackItem:a,getTag:s}=e;const[l,c]=this.getTextSize(t),d=2*l,u=this.duration(t)*d/(this.resolution.x+d)+S.nextDanmakuDelay;let p=n,m=null;const h=t=>r(t,p,d);do{m=i.find(h),p+=o}while(m&&p<=this.trackCount&&p>=0);return p>this.trackCount||p<0?\"\\\\pos(0,-999)\":(p-=o,i.push(a(p,d,u)),s({trackNumber:p,x:l,y:c}))}getHorizontalTags(t){return this.getTags(t,{targetTrack:this.horizontalTrack,initTrackNumber:0,nextTrackNumber:1,willOverlay:(e,i,n)=>e.trackNumber===i&&(e.width<n?this.duration(t)*this.resolution.x/(this.resolution.x+n)<=e.end-t.startTime:e.visible>t.startTime),getTrackItem:(e,i,n)=>({width:i,start:t.startTime,visible:t.startTime+n,end:t.startTime+this.duration(t),trackNumber:e}),getTag:e=>{let{trackNumber:i,x:n,y:o}=e;return`\\\\move(${this.resolution.x+n},${i*this.trackHeight+S.margin+o},${-n},${i*this.trackHeight+S.margin+o},0,${1e3*this.duration(t)})`}})}getVerticalTags(t){const e=\"top\"===S.danmakuType[t.type];return this.getTags(t,{targetTrack:this.verticalTrack,initTrackNumber:e?0:this.trackCount-1,nextTrackNumber:e?1:-1,willOverlay:(e,i)=>e.trackNumber===i&&e.end>t.startTime,getTrackItem:e=>({start:t.startTime,end:t.startTime+this.duration(t),trackNumber:e}),getTag:t=>{let{trackNumber:i,y:n}=t;return e?`\\\\pos(${this.resolution.x/2},${i*this.trackHeight+S.margin+n})`:`\\\\pos(${this.resolution.x/2},${this.resolution.y-S.margin-n-(this.trackCount-1-i)*this.trackHeight})`}})}push(t){let e=\"\",i=[];switch(S.danmakuType[t.type]){case\"normal\":case\"reversed\":e=this.getHorizontalTags(t),i=this.horizontalStack;break;case\"top\":case\"bottom\":e=this.getVerticalTags(t),i=this.verticalStack;break;default:return{tags:\"\\\\pos(0,-999)\"}}const n={tags:e};return i.push(n),n}}function w(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}b(S,\"danmakuType\",{[v.Normal]:\"normal\",[v.Normal2]:\"normal\",[v.Normal3]:\"normal\",[v.Bottom]:\"bottom\",[v.Top]:\"top\",[v.Reversed]:\"reversed\",[v.Special]:\"special\",[v.Special2]:\"special\"}),b(S,\"margin\",4),b(S,\"nextDanmakuDelay\",.05);class k{constructor(t){let{title:e,font:i,alpha:n,duration:o,blockTypes:r,blockFilter:a,resolution:s,bottomMarginPercent:l,bold:c}=t;w(this,\"title\",void 0),w(this,\"font\",void 0),w(this,\"alpha\",void 0),w(this,\"duration\",void 0),w(this,\"blockTypes\",void 0),w(this,\"blockFilter\",void 0),w(this,\"resolution\",void 0),w(this,\"bold\",void 0),w(this,\"danmakuStack\",void 0),this.title=e,this.font=i,this.alpha=Math.round(255*n).toString(16).toUpperCase().padStart(2,\"0\"),this.duration=o,this.blockTypes=r,this.blockFilter=a||(()=>!0),this.resolution=s,this.bold=c,this.danmakuStack=new S(i,s,o,l)}get fontStyles(){return{36:`Style: Larger,${this.font},72,&H${this.alpha}FFFFFF,&H${this.alpha}FFFFFF,&H${this.alpha}000000,&H${this.alpha}000000,${this.bold?\"1\":\"0\"},0,0,0,100,100,0,0,1,1.2,0,5,0,0,0,0`,30:`Style: Large,${this.font},64,&H${this.alpha}FFFFFF,&H${this.alpha}FFFFFF,&H${this.alpha}000000,&H${this.alpha}000000,${this.bold?\"1\":\"0\"},0,0,0,100,100,0,0,1,1.2,0,5,0,0,0,0`,25:`Style: Medium,${this.font},52,&H${this.alpha}FFFFFF,&H${this.alpha}FFFFFF,&H${this.alpha}000000,&H${this.alpha}000000,${this.bold?\"1\":\"0\"},0,0,0,100,100,0,0,1,1.2,0,5,0,0,0,0`,18:`Style: Small,${this.font},36,&H${this.alpha}FFFFFF,&H${this.alpha}FFFFFF,&H${this.alpha}000000,&H${this.alpha}000000,${this.bold?\"1\":\"0\"},0,0,0,100,100,0,0,1,1.2,0,5,0,0,0,0`,45:`Style: ExtraLarge,${this.font},90,&H${this.alpha}FFFFFF,&H${this.alpha}FFFFFF,&H${this.alpha}000000,&H${this.alpha}000000,${this.bold?\"1\":\"0\"},0,0,0,100,100,0,0,1,1.2,0,5,0,0,0,0`}}xmlDanmakuToAssDocument(t){const e=[];for(const i of t){const t=-1!==this.blockTypes.indexOf(i.type),n=-1!==this.blockTypes.indexOf(\"color\")&&i.color!==k.white;if(t||n)continue;if(!this.blockFilter(i))continue;const[o,r]=(0,s.convertTimeByDuration)(i.startTime,this.duration(i));e.push(new u({content:(0,s.normalizeContent)(i.content),time:o,endTime:r,type:i.type.valueOf().toString(),fontSize:i.fontSize.toString(),color:i.color.toString(),typeTag:this.convertType(i),colorTag:(0,s.convertHexColorForDialogue)(i.color.toString(16))}))}return new p(e,this.title,this.fontStyles,this.blockTypes,this.resolution)}xmlStringToAssDocument(t){const e=new y(t);return this.xmlDanmakuToAssDocument(e.danmakus.sort((0,r.ascendingSort)((t=>t.startTime))))}convertType(t){return this.danmakuStack.push(t).tags}}w(k,\"white\",16777215);const T=coreApis.componentApis.video.playerAgent;var x=i(905);function $(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class F{constructor(t,e){this.aid=t,this.cid=e,$(this,\"jsonDanmakus\",[])}get xmlDanmakus(){return this.jsonDanmakus.map((t=>({content:t.content,time:t.progress?(t.progress/1e3).toString():\"0\",type:t.mode?.toString()??\"1\",fontSize:t.fontsize?.toString()??\"25\",color:t.color?.toString()??\"16777215\",timeStamp:t.ctime?.toString()??\"0\",pool:t.pool?.toString()??\"0\",userHash:t.midHash??\"0\",rowId:t.idStr??\"0\"})))}async fetchInfo(){const{getDanmakuSegment:t,getDanmakuView:e}=await Promise.resolve().then(i.bind(i,186)),n=await e(this.aid,this.cid),{total:a}=n.dmSge;if(void 0===a)throw new Error(`获取弹幕分页数失败: ${JSON.stringify(lodash.omit(n,\"flag\"))}`);console.log(\"segment count =\",a);const s=await Promise.all(new Array(a).fill(0).map((async(e,i)=>{try{const e=await t(this.aid,this.cid,i),n=e.elems??[];return console.log(`received blob for segment ${i+1}, count = ${n.length}, result =`,e),n}catch(t){throw(0,o.logError)(t),t}})));return this.jsonDanmakus=s.flat().sort((0,r.ascendingSort)((t=>t.progress??0))),this}}const D=async()=>{const t=(0,x.getComponentSettings)(\"downloadDanmaku\").options,e=(0,a.getFriendlyTitle)(),i={font:\"微软雅黑\",alpha:.4,duration:t=>{switch(t.type){case 4:case 5:return 4;default:return 6}},blockTypes:[7,8],resolution:{x:1920,y:1080},bottomMarginPercent:.15,bold:!1};let r={...i,title:e};try{await(0,n.loadDanmakuSettingsPanel)();if(localStorage.getItem(\"bilibili_player_settings\")){r.blockTypes=(()=>{const t=[],e={scroll:[1,2,3],top:[5],bottom:[4],color:[\"color\"]};for(const[i,n]of Object.entries(e))!1===T.playerAgent.getPlayerConfig(`block.type_${i}`,!0)&&t.push(...n);return t.concat(7,8)})(),r.bold=T.playerAgent.getPlayerConfig(\"dmSetting.bold\",!1),r.alpha=lodash.clamp(1-parseFloat(T.playerAgent.getPlayerConfig(\"dmSetting.opacity\",\"0.4\")),0,1);const e=1.4-.4*T.playerAgent.getPlayerConfig(\"dmSetting.fontsize\",1);r.resolution={x:Math.round(1920*e),y:Math.round(1080*e)},r.duration=(()=>{const e=18-3*(\"auto\"===t.speed?T.playerAgent.getPlayerConfig(\"dmSetting.speedplus\",0):t.speed);return t=>{switch(t.type){case 4:case 5:return 4;default:return e}}})();const i=T.playerAgent.getPlayerConfig(\"dmSetting.danmakuArea\",0);r.bottomMarginPercent=i>=100?0:i/100,0===r.bottomMarginPercent&&T.playerAgent.getPlayerConfig(\"dmSetting.preventshade\",!1)&&(r.bottomMarginPercent=.15);const n=T.playerAgent.getPlayerConfig(\"block.list\",[]);r.blockFilter=t=>{for(const e of n)if(e.s)switch(e.t){default:return!0;case\"keyword\":if(t.content.includes(e.v))return!1;break;case\"regexp\":if(new RegExp(e.v).test(t.content))return!1;break;case\"user\":if(t.userHash===e.v)return!1}return!0}}else console.warn(\"[弹幕转换] 未找到播放器设置\"),r={...r,...i};r.font=dq(\":is(.bilibili-player-video-danmaku-setting-right-font, .bpx-player-dm-setting-right-font-content-fontfamily) .bui-select-result\").innerText}catch(t){(0,o.logError)(t),r={...r,...i}}for(const[t,e]of Object.entries(r))null==e&&(console.warn(\"danmaku config invalid for key\",t,\", value =\",e),r[t]=i[e]);return console.log(r),r},C=async t=>new k(await D()).xmlDanmakuToAssDocument(t.xmlDanmakus.map((t=>new f(t)))).generateAss(),A=t=>`\\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><i><chatserver>chat.bilibili.com</chatserver><chatid>${t.cid}</chatid><mission>0</mission><maxlimit>${t.xmlDanmakus.length}</maxlimit><state>0</state><real_name>0</real_name><source>k-v</source>\\n${t.xmlDanmakus.map((t=>`  ${new f(t).text()}`)).join(\"\\n\")}\\n</i>\\n  `.trim(),P=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:unsafeWindow;const{aid:i,cid:n}=e,o=await new F(i,n).fetchInfo();switch(t){case\"xml\":return new Blob([A(o)],{type:\"text/xml\"});default:case\"json\":return new Blob([JSON.stringify(o.jsonDanmakus,void 0,2)],{type:\"text/json\"});case\"ass\":return new Blob([await C(o)],{type:\"text/ass\"})}}},237:(t,e,i)=>{var n=i(955)((function(t){return t[1]}));n.push([t.id,\".download-danmaku-config.download-video-config-section .be-dropdown {\\n  text-transform: uppercase;\\n}\",\"\"]),t.exports=n},955:t=>{\"use strict\";\n// eslint-disable-next-line func-names\nt.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?\"@media \".concat(e[2],\" {\").concat(i,\"}\"):i})).join(\"\")},\n// eslint-disable-next-line func-names\ne.i=function(t,i,n){\"string\"==typeof t&&(\n// eslint-disable-next-line no-param-reassign\nt=[[null,t,\"\"]]);var o={};if(n)for(var r=0;r<this.length;r++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[r][0];null!=a&&(o[a]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);n&&o[l[0]]||(i&&(l[2]?l[2]=\"\".concat(i,\" and \").concat(l[2]):l[2]=i),e.push(l))}},e}},991:(t,e,i)=>{\"use strict\";var n,o=function(){return void 0===n&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\nn=Boolean(window&&document&&document.all&&!window.atob)),n},r=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function s(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],o=0;o<t.length;o++){var r=t[o],l=e.base?r[0]+e.base:r[0],c=i[l]||0,d=\"\".concat(l,\" \").concat(c);i[l]=c+1;var u=s(d),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(a[u].references++,a[u].updater(p)):a.push({identifier:d,updater:y(p,e),references:1}),n.push(d)}return n}function c(t){var e=document.createElement(\"style\"),n=t.attributes||{};if(void 0===n.nonce){var o=i.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),\"function\"==typeof t.insert)t.insert(e);else{var a=r(t.insert||\"head\");if(!a)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");a.appendChild(e)}return e}var d,u=(d=[],function(t,e){return d[t]=e,d.filter(Boolean).join(\"\\n\")});function p(t,e,i,n){var o=i?\"\":n.media?\"@media \".concat(n.media,\" {\").concat(n.css,\"}\"):n.css;if(t.styleSheet)t.styleSheet.cssText=u(e,o);else{var r=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}function m(t,e,i){var n=i.css,o=i.media,r=i.sourceMap;if(o?t.setAttribute(\"media\",o):t.removeAttribute(\"media\"),r&&\"undefined\"!=typeof btoa&&(n+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\" */\")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var h=null,f=0;function y(t,e){var i,n,o;if(e.singleton){var r=f++;i=h||(h=c(e)),n=p.bind(null,i,r,!1),o=p.bind(null,i,r,!0)}else i=c(e),n=m.bind(null,i,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||\"boolean\"==typeof e.singleton||(e.singleton=o());var i=l(t=t||[],e);return function(t){if(t=t||[],\"[object Array]\"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var o=s(i[n]);a[o].references--}for(var r=l(t,e),c=0;c<i.length;c++){var d=s(i[c]);0===a[d].references&&(a[d].updater(),a.splice(d,1))}i=r}}}},662:(t,e,i)=>{\"use strict\";i.r(e),i.d(e,{default:()=>u});var n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(\"div\",{staticClass:\"multiple-widgets\"},[e(\"DefaultWidget\",{attrs:{disabled:t.disabled,name:\"下载弹幕 (XML)\",icon:\"danmaku\"},on:{click:function(e){return t.download(\"xml\")}}}),t._v(\" \"),e(\"DefaultWidget\",{attrs:{disabled:t.disabled,name:\"下载弹幕 (JSON)\",icon:\"danmaku\"},on:{click:function(e){return t.download(\"json\")}}}),t._v(\" \"),e(\"DefaultWidget\",{attrs:{disabled:t.disabled,name:\"下载弹幕 (ASS)\",icon:\"danmaku\"},on:{click:function(e){return t.download(\"ass\")}}})],1)};n._withStripped=!0;const o=coreApis.download;var r=i(765),a=i(121);const s=coreApis.pluginApis.data;var l=i(164);var c=i(202);(0,s.addData)(\"ui.icons\",(t=>{t.danmaku='<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\"  viewBox=\"0 0 24 24\"><path d=\"M20,4H4C2.9,4,2,4.9,2,6v12c0,1.1,0.9,2,2,2h4h5.9H20c1.1,0,2-0.9,2-2V6C22,4.9,21.1,4,20,4z M5,7h8v2H5V7z M7,17H5v-2h2V17z M6.3,13v-2H18v2H6.3z M19,17H9v-2h10V17z M19,9h-4.1V7H19V9z\"/></svg>'}));const d=Vue.extend({components:{DefaultWidget:l.DefaultWidget},data:()=>({disabled:!1}),methods:{async download(t){try{this.disabled=!0;const e=(0,a.getFriendlyTitle)(),i=await(0,c.getBlobByType)(t);await o.DownloadPackage.single(`${e}.${t}`,i)}catch(t){(0,r.logError)(t)}finally{this.disabled=!1}}}});const u=(0,i(678).A)(d,n,[],!1,null,null,null).exports},528:(t,e,i)=>{\"use strict\";i.r(e),i.d(e,{default:()=>m});var n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(\"div\",{staticClass:\"download-danmaku-config download-video-config-section\"},[e(\"div\",{staticClass:\"download-video-config-item\"},[e(\"div\",{staticClass:\"download-video-config-title\"},[t._v(\"弹幕:\")]),t._v(\" \"),e(\"VDropdown\",{attrs:{items:t.items},scopedSlots:t._u([{key:\"item\",fn:function({item:e}){return[t._v(\"\\n        \"+t._s(e)+\"\\n      \")]}}]),model:{value:t.type,callback:function(e){t.type=e},expression:\"type\"}})],1)])};n._withStripped=!0;var o=i(905),r=i(164);const a=(0,o.getComponentSettings)(\"downloadVideo\").options,s=Vue.extend({components:{VDropdown:r.VDropdown},data:()=>({type:a.danmakuType??\"无\",items:[\"无\",\"ass\",\"json\",\"xml\"]}),computed:{enabled(){return\"无\"!==this.type}},watch:{type(t){a.danmakuType=t}}});var l=i(991),c=i.n(l),d=i(237),u=i.n(d),p={insert:\"head\",singleton:!1};c()(u(),p);u().locals;const m=(0,i(678).A)(s,n,[],!1,null,null,null).exports},678:(t,e,i)=>{\"use strict\";function n(t,e,i,n,o,r,a,s){var l,c=\"function\"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId=\"data-v-\"+r),a?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):o&&(l=s?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}i.d(e,{A:()=>n})},905:t=>{\"use strict\";t.exports=coreApis.settings},164:t=>{\"use strict\";t.exports=coreApis.ui},765:t=>{\"use strict\";t.exports=coreApis.utils.log},121:t=>{\"use strict\";t.exports=coreApis.utils.title}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={id:n,exports:{}};return t[n](r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.nc=void 0;var n={};return(()=>{\"use strict\";i.d(n,{component:()=>s});const t=coreApis.componentApis.define,e=coreApis.spinQuery,o=coreApis.toast,r=coreApis.utils.urls,a=(0,t.defineOptionsMetadata)({speed:{defaultValue:\"auto\",hidden:!0}}),s=(0,t.defineComponentMetadata)({name:\"downloadDanmaku\",displayName:\"下载弹幕\",description:{\"zh-CN\":\"启用下载弹幕支持, 在视频和番剧页面中可从功能面板里下载弹幕. 请注意 ASS 弹幕下载不会包含高级弹幕, 字幕弹幕等.\"},tags:[componentsTags.video],entry:none,reload:none,unload:none,options:a,plugin:{displayName:\"下载视频 - 下载弹幕支持\",setup:t=>{let{addData:e}=t;e(\"downloadVideo.assets\",(async t=>{const{getBlobByType:e}=await Promise.resolve().then(i.bind(i,202));t.push({name:\"downloadDanmaku\",displayName:\"下载弹幕\",getAssets:async(t,i)=>{const{type:n,enabled:r}=i;if(!r)return[];const a=o.Toast.info(\"获取弹幕中...\",\"下载弹幕\");let s=0;const l=await Promise.allSettled(t.map((async i=>{const o=await e(n,i.input);return s++,a.message=`获取弹幕中... (${s}/${t.length})`,{name:`${i.input.title}.${n}`,data:o}}))),c=l.filter((t=>\"fulfilled\"===t.status)),d=l.filter((t=>\"rejected\"===t.status));return a.message=`获取完成. 成功 ${c.length} 个, 失败 ${d.length} 个.`,c.map((t=>t.value))},component:()=>Promise.resolve().then(i.bind(i,528)).then((t=>t.default))})}))}},urlInclude:r.videoAndBangumiUrls,widget:{condition:e.hasVideo,component:()=>Promise.resolve().then(i.bind(i,662)).then((t=>t.default))},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"})})(),n=n.component})()));",
      "metadata": {
        "name": "downloadDanmaku",
        "displayName": "下载弹幕",
        "description": {
          "zh-CN": "启用下载弹幕支持, 在视频和番剧页面中可从功能面板里下载弹幕. 请注意 ASS 弹幕下载不会包含高级弹幕, 字幕弹幕等."
        },
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "options": {
          "speed": {
            "defaultValue": "auto",
            "hidden": true
          }
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {
          "speed": "auto"
        }
      }
    },
    "downloadVideo": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"video/download\"]=t():e[\"video/download\"]=t()}(globalThis,(()=>(()=>{var e,t,i={385:(e,t,i)=>{\"use strict\";i.d(t,{vx:()=>h,oD:()=>p,EA:()=>w,E:()=>y,En:()=>g,WO:()=>b});var n=i(416),o=i(847);const s=coreApis.utils.sort;var a=i(179),d=i(161),r=i(849),l=i(882),c=i(84),u=i(905);const p={video:\".mp4\",audio:\".m4a\",flacAudio:\".flac\"};let h=function(e){return e.Avc=\"AVC/H.264\",e.Hevc=\"HEVC/H.265\",e.Av1=\"AV1\",e}({});const f=e=>{const{options:t}=(0,u.getComponentSettings)(\"downloadVideo\");return\"video\"===e?t.dashVideoExtension:\"audio\"===e?t.dashAudioExtension:\"flacAudio\"===e?t.dashFlacAudioExtension:p[e]??\".m4s\"},m=e=>({url:e.downloadUrl,backupUrls:e.backupUrls,length:e.duration,size:Math.trunc(e.bandWidth*e.duration/8),extension:f(e.type)}),v=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{codec:i=h.Avc,filters:p}=t,f={video:()=>!0,audio:()=>!0,...p},{aid:v,cid:g,quality:b}=e,y={avid:v,cid:g,qn:b?.value??\"\",otype:\"json\",fourk:1,fnver:0,fnval:4048},w=d.bangumiUrls.some((e=>(0,o.matchUrlPattern)(e))),x=w?(0,c.i)((0,o.formData)(y)):(0,c.y)((0,o.formData)(y)),_=await(0,n.bilibiliApi)((0,n.getJsonWithCredentials)(x),\"获取视频链接失败\");if(!_.dash)throw new Error(\"此视频没有 dash 格式, 请改用其他格式.\");const k=a.allQualities.find((e=>e.value===_.quality)),{duration:I,video:C,audio:A,dolby:V,flac:D}=_.dash,S=e=>{switch(e){case 12:return h.Hevc;case 13:return h.Av1;default:return h.Avc}},E=C.filter((e=>e.id===k.value)).map((e=>({type:\"video\",videoCodec:S(e.codecid),quality:k,width:e.width,height:e.height,codecs:e.codecs,codecId:e.codecid,bandWidth:e.bandwidth,frameRate:e.frameRate,backupUrls:(e.backupUrl||e.backup_url||[]).map((e=>e.replace(\"http:\",\"https:\"))),downloadUrl:(e.baseUrl||e.base_url||\"\").replace(\"http:\",\"https:\"),duration:I}))).filter((e=>f.video(e))),O=function(e){return{type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"audio\",bandWidth:e.bandwidth,codecs:e.codecs,codecId:e.codecid??0,backupUrls:(e.backupUrl||e.backup_url||[]).map((e=>e.replace(\"http:\",\"https:\"))),downloadUrl:(e.baseUrl||e.base_url||\"\").replace(\"http:\",\"https:\"),duration:I}},U=(A||[]).map((e=>O(e))).filter((e=>f.audio(e)));V&&U.push(...V.audio?.map((e=>O(e)))??[]),D&&U.push(...D.audio?[O(D.audio,\"flacAudio\")]:[]);const T=(e=>{const{videoDashes:t,audioDashes:i,videoCodec:n}=e,o=[];if(0!==t.length){const e=e=>e.videoCodec===n;if(t.some(e)){const i=t.filter(e).sort((0,s.ascendingSort)((e=>e.bandWidth)))[0];o.push(m(i))}else o.push(m(t.sort((0,s.ascendingSort)((e=>e.bandWidth)))[0]))}if(0!==i.length){const e=i.sort((0,s.descendingSort)((e=>e.bandWidth)))[0];o.push(m(e))}return o})({audioDashes:U,videoDashes:E,videoCodec:i}),$=(()=>{const e=e=>_.accept_quality.filter((t=>null===e||C.some((i=>i.id===t&&S(i.codecid)===e)))).map((e=>a.allQualities.find((t=>t.value===e)))).filter((e=>void 0!==e)),t=e(i);if(t.length>0)return t;const{options:n}=(0,u.getComponentSettings)(\"downloadVideo\"),o=e(n.dashCodecFallback);return o.length>0?o:e(null)})(),j=new l._({input:e,jsonData:_,fragments:T,qualities:$,currentQuality:k});return(0,r.X)(e,j),j},g={name:\"video.dash.avc\",displayName:\"dash (AVC/H.264)\",description:\"音画分离的 mp4 格式, 编码为 H.264, 体积较大, 兼容性较好. 下载后可以合并为单个 mp4 文件. 如果视频源没有此编码, 则会回退到设置中设定的 DASH 回退编码.\",downloadVideoInfo:async e=>v(e,{codec:h.Avc})},b={name:\"video.dash.hevc\",displayName:\"dash (HEVC/H.265)\",description:\"音画分离的 mp4 格式, 编码为 H.265, 体积中等, 兼容性较差. 下载后可以合并为单个 mp4 文件. 如果视频源没有此编码, 则会回退到设置中设定的 DASH 回退编码.\",downloadVideoInfo:async e=>v(e,{codec:h.Hevc})},y={name:\"video.dash.av1\",displayName:\"dash (AV1)\",description:\"音画分离的 mp4 格式, 编码为 AV1, 体积较小, 兼容性中等. 下载后可以合并为单个 mp4 文件. 如果视频源没有此编码, 则会回退到设置中设定的 DASH 回退编码.\",downloadVideoInfo:async e=>v(e,{codec:h.Av1})},w={name:\"video.dash.audio\",displayName:\"dash (仅音频)\",description:\"仅下载视频中的音频轨道.\",downloadVideoInfo:async e=>v(e,{filters:{video:()=>!1}})}},84:(e,t,i)=>{\"use strict\";i.d(t,{i:()=>o,y:()=>n});const n=e=>`https://api.bilibili.com/x/player/playurl?${e}`,o=e=>`https://api.bilibili.com/pgc/player/web/playurl?${e}`},849:(e,t,i)=>{\"use strict\";i.d(t,{X:()=>o});var n=i(179);const o=(e,t)=>{e.quality&&t.currentQuality.value!==e.quality.value&&(e.allowQualityDrop?console.warn(`'${e.title}' 不支持选择的清晰度${e.quality.displayName}, 已降级为${t.currentQuality.displayName}`):(e=>{if(n.vipRequiredQualities.find((t=>t.value===e)))throw new Error(\"您选择的清晰度需要大会员, 请更改清晰度后重试.\");if(n.loginRequiredQualities.find((t=>t.value===e)))throw new Error(\"您选择的清晰度需要先登录.\");throw new Error(\"获取下载链接失败, 请尝试更换清晰度或更换格式.\")})(e.quality.value))}},882:(e,t,i)=>{\"use strict\";i.d(t,{C:()=>r,_:()=>d});const n=coreApis.download;var o=i(82),s=i(121);function a(e,t,i){return(t=function(e){var t=function(e,t){if(\"object\"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"==typeof t?t:t+\"\"}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d{constructor(e){a(this,\"input\",void 0),a(this,\"fragments\",void 0),a(this,\"qualities\",void 0),a(this,\"currentQuality\",void 0),a(this,\"jsonData\",void 0),Object.assign(this,e)}get totalSize(){return lodash.sumBy(this.fragments,(e=>e.size))}get totalLength(){return lodash.sumBy(this.fragments,(e=>e.length))}get titledFragments(){return this.fragments.map(((e,t)=>{const i=this.fragments.filter((t=>t.extension===e.extension)).length>1?` - ${(0,o.formatNumber)(t+1,this.fragments.length)}`:\"\";return{...e,title:`${this.input.title}${i}${e.extension}`}}))}}class r{constructor(e){this.infos=e,a(this,\"inputs\",[]),a(this,\"extraAssets\",[]),a(this,\"extraOnlineAssets\",[]),this.inputs=e.map((e=>e.input))}get isSingleVideo(){return this.inputs.length<2}async downloadExtraAssets(){console.log(\"[downloadExtraAssets]\",this.extraAssets);const e=`${(0,s.getFriendlyTitle)(!1)}.zip`,{infos:t}=this,i=(await Promise.all([...this.extraAssets,...this.extraOnlineAssets].map((e=>{let{asset:i,instance:n}=e;return i.getAssets(t,n)})))).flat();await new n.DownloadPackage(i).emit(e)}}},227:(e,t,i)=>{var n=i(955)((function(e){return e[1]}));n.push([e.id,\".download-video-panel {\\n  background-color: #fff;\\n  color: black;\\n  border-radius: 8px;\\n  border: 1px solid #8882;\\n  box-sizing: border-box;\\n  box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.05);\\n  font-size: 12px;\\n  padding: 6px;\\n  top: 100px;\\n  left: 50%;\\n  transform: translateX(-50%) scale(0.95);\\n  transition: 0.2s ease-out;\\n  z-index: 1000;\\n  width: 320px;\\n  height: calc(100vh - 200px);\\n  display: flex;\\n  flex-direction: column;\\n}\\nbody.dark .download-video-panel {\\n  box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.2);\\n}\\nbody.dark .download-video-panel {\\n  background-color: #282828;\\n  color: #eee;\\n}\\n.download-video-panel.open {\\n  transform: translateX(-50%);\\n}\\n.download-video-panel .be-textbox,\\n.download-video-panel .be-textarea {\\n  flex-grow: 1;\\n}\\n.download-video-panel-header {\\n  display: flex;\\n  align-items: center;\\n  border-bottom: 1px solid #8882;\\n  padding: 6px 0;\\n  margin: 0 6px;\\n}\\n.download-video-panel-header .title {\\n  font-size: 16px;\\n  font-weight: 600;\\n  flex-grow: 1;\\n  margin: 0 8px;\\n}\\n.download-video-panel-header .be-button {\\n  padding: 4px;\\n}\\n.download-video-panel-content {\\n  overflow: auto;\\n  scrollbar-width: none !important;\\n  overscroll-behavior: contain;\\n  display: flex;\\n  align-items: stretch;\\n  flex-direction: column;\\n  flex: 1 0 0;\\n  padding: 12px 6px;\\n  align-items: flex-start;\\n}\\n.download-video-panel-content::-webkit-scrollbar {\\n  height: 0 !important;\\n  width: 0 !important;\\n}\\n.download-video-panel-content > :not(:first-child) {\\n  margin-top: 12px;\\n}\\n.download-video-panel .download-video-config-item {\\n  display: flex;\\n  align-items: center;\\n}\\n.download-video-panel .download-video-config-item .download-video-config-title {\\n  margin-right: 8px;\\n}\\n.download-video-panel .download-video-config-item.error {\\n  color: #e57373;\\n}\\n.download-video-panel .download-video-config-section {\\n  align-self: stretch;\\n}\\n.download-video-panel .download-video-config-description {\\n  color: #888d;\\n  margin-top: 4px;\\n}\\n.download-video-panel .download-video-config-description a {\\n  color: var(--theme-color-70);\\n}\\n.download-video-panel-footer {\\n  display: flex;\\n  align-items: center;\\n  border-top: 1px solid #8882;\\n  padding: 6px 0;\\n  margin: 0 6px;\\n  justify-content: center;\\n}\\n.download-video-panel .run-download {\\n  font-size: 13px;\\n  padding: 6px 12px;\\n}\",\"\"]),e.exports=n},174:(e,t,i)=>{var n=i(955)((function(e){return e[1]}));n.push([e.id,\".episodes-picker-header {\\n  display: flex;\\n  align-items: center;\\n}\\n.episodes-picker-checked-ratio {\\n  flex-grow: 1;\\n  margin-left: 4px;\\n}\\n.episodes-picker-actions {\\n  display: flex;\\n  align-items: center;\\n}\\n.episodes-picker-actions .be-button {\\n  padding: 4px;\\n}\\n.episodes-picker-actions .be-button.invert-selection .be-icon {\\n  font-size: 14px;\\n}\\n.episodes-picker-actions .be-button.select-all .be-icon, .episodes-picker-actions .be-button.deselect-all .be-icon {\\n  transform: translateY(1px);\\n}\\n.episodes-picker-items {\\n  max-height: 400px;\\n  overflow: auto;\\n}\\n.episodes-picker-items:not(:empty) {\\n  margin-top: 4px;\\n  border: 1px solid #8884;\\n  border-radius: 6px;\\n}\\n.episodes-picker-items .be-check-box {\\n  padding: 2px 6px;\\n}\\n.episodes-picker-items .episode-duration {\\n  margin-right: 4px;\\n  text-align: right;\\n  flex: 1 1 0;\\n  opacity: 0.5;\\n}\\n.episodes-picker-empty {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  padding: 4px 0;\\n}\",\"\"]),e.exports=n},495:(e,t,i)=>{var n=i(955)((function(e){return e[1]}));n.push([e.id,\".single-video-info.download-video-config-section {\\n  position: relative;\\n  height: 125px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n.single-video-info.download-video-config-section img {\\n  height: 125px;\\n  object-fit: contain;\\n  border-radius: 8px;\\n}\\n.single-video-info.download-video-config-section img.shadow {\\n  position: absolute;\\n  filter: blur(8px) brightness(0.8);\\n  transform: scaleY(0.95) translateY(4px);\\n  z-index: -1;\\n  opacity: 0.3;\\n}\",\"\"]),e.exports=n},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?\"@media \".concat(t[2],\" {\").concat(i,\"}\"):i})).join(\"\")},\n// eslint-disable-next-line func-names\nt.i=function(e,i,n){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var o={};if(n)for(var s=0;s<this.length;s++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[s][0];null!=a&&(o[a]=!0)}for(var d=0;d<e.length;d++){var r=[].concat(e[d]);n&&o[r[0]]||(i&&(r[2]?r[2]=\"\".concat(i,\" and \").concat(r[2]):r[2]=i),t.push(r))}},t}},991:(e,t,i)=>{\"use strict\";var n,o=function(){return void 0===n&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\nn=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),a=[];function d(e){for(var t=-1,i=0;i<a.length;i++)if(a[i].identifier===e){t=i;break}return t}function r(e,t){for(var i={},n=[],o=0;o<e.length;o++){var s=e[o],r=t.base?s[0]+t.base:s[0],l=i[r]||0,c=\"\".concat(r,\" \").concat(l);i[r]=l+1;var u=d(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(a[u].references++,a[u].updater(p)):a.push({identifier:c,updater:v(p,t),references:1}),n.push(c)}return n}function l(e){var t=document.createElement(\"style\"),n=e.attributes||{};if(void 0===n.nonce){var o=i.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),\"function\"==typeof e.insert)e.insert(t);else{var a=s(e.insert||\"head\");if(!a)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");a.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join(\"\\n\")});function p(e,t,i,n){var o=i?\"\":n.media?\"@media \".concat(n.media,\" {\").concat(n.css,\"}\"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var s=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function h(e,t,i){var n=i.css,o=i.media,s=i.sourceMap;if(o?e.setAttribute(\"media\",o):e.removeAttribute(\"media\"),s&&\"undefined\"!=typeof btoa&&(n+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s)))),\" */\")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var f=null,m=0;function v(e,t){var i,n,o;if(t.singleton){var s=m++;i=f||(f=l(t)),n=p.bind(null,i,s,!1),o=p.bind(null,i,s,!0)}else i=l(t),n=h.bind(null,i,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||\"boolean\"==typeof t.singleton||(t.singleton=o());var i=r(e=e||[],t);return function(e){if(e=e||[],\"[object Array]\"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var o=d(i[n]);a[o].references--}for(var s=r(e,t),l=0;l<i.length;l++){var c=d(i[l]);0===a[c].references&&(a[c].updater(),a.splice(c,1))}i=s}}}},14:(e,t,i)=>{\"use strict\";i.r(t),i.d(t,{default:()=>G});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"VPopup\",{staticClass:\"download-video-panel\",attrs:{fixed:\"\",\"trigger-element\":e.triggerElement},model:{value:e.open,callback:function(t){e.open=t},expression:\"open\"}},[t(\"div\",{staticClass:\"download-video-panel-header\"},[t(\"VIcon\",{attrs:{icon:\"mdi-download\"}}),e._v(\" \"),t(\"div\",{staticClass:\"title\"},[e._v(\"下载视频\")]),e._v(\" \"),t(\"VButton\",{attrs:{type:\"transparent\",title:\"关闭\"},on:{click:function(t){e.open=!1}}},[t(\"VIcon\",{attrs:{icon:\"mdi-close\",size:20}})],1)],1),e._v(\" \"),t(\"div\",{staticClass:\"download-video-panel-content\"},[e.selectedInput?t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"输入源:\")]),e._v(\" \"),t(\"VDropdown\",{attrs:{items:e.inputs},model:{value:e.selectedInput,callback:function(t){e.selectedInput=t},expression:\"selectedInput\"}})],1):e._e(),e._v(\" \"),0===e.inputs.length?t(\"div\",{staticClass:\"download-video-config-item error\"},[e._v(\"\\n      没有匹配的输入源, 请确保安装了适合此页面的插件.\\n    \")]):e._e(),e._v(\" \"),e.selectedInput&&e.selectedInput.component?t(e.selectedInput.component,{ref:\"inputOptions\",tag:\"component\"}):e._e(),e._v(\" \"),e.selectedApi?t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"格式:\")]),e._v(\" \"),t(\"VDropdown\",{attrs:{items:e.apis},model:{value:e.selectedApi,callback:function(t){e.selectedApi=t},expression:\"selectedApi\"}})],1):e._e(),e._v(\" \"),e.selectedApi&&e.selectedApi.description?t(\"div\",{staticClass:\"download-video-config-description\",domProps:{innerHTML:e._s(e.selectedApi.description)}}):e._e(),e._v(\" \"),e.selectedQuality?t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"清晰度:\")]),e._v(\" \"),t(\"VDropdown\",{attrs:{items:e.filteredQualities},on:{change:function(t){return e.saveSelectedQuality()}},model:{value:e.selectedQuality,callback:function(t){e.selectedQuality=t},expression:\"selectedQuality\"}})],1):e._e(),e._v(\" \"),!e.testData.multiple&&e.selectedQuality?[e.testData.videoInfo?t(\"div\",{staticClass:\"download-video-config-description\"},[e._v(\"\\n        预计大小: \"+e._s(e.formatFileSize(e.testData.videoInfo.totalSize))+\"\\n      \")]):e._e(),e._v(\" \"),null===e.testData.videoInfo?t(\"div\",{staticClass:\"download-video-config-description\"},[e._v(\"\\n        正在计算大小\\n      \")]):e._e()]:e._e(),e._v(\" \"),t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"使用备用下载地址:\")]),e._v(\" \"),t(\"SwitchBox\",{model:{value:e.useBackupUrls,callback:function(t){e.useBackupUrls=t},expression:\"useBackupUrls\"}})],1),e._v(\" \"),t(\"div\",{staticClass:\"download-video-config-description\"},[e._v(\"\\n      若默认下载地址速度缓慢, 可以尝试更换备用下载地址.\\n    \")]),e._v(\" \"),e._l(e.assetsWithOptions,(function(e){return t(e.component,{key:e.name,ref:\"assetsOptions\",refInFor:!0,tag:\"component\",attrs:{name:e.name}})})),e._v(\" \"),e.selectedOutput?t(\"div\",{staticClass:\"download-video-config-item\"},[t(\"div\",{staticClass:\"download-video-config-title\"},[e._v(\"输出方式:\")]),e._v(\" \"),t(\"VDropdown\",{attrs:{items:e.outputs},model:{value:e.selectedOutput,callback:function(t){e.selectedOutput=t},expression:\"selectedOutput\"}})],1):e._e(),e._v(\" \"),e.selectedOutput&&e.selectedOutput.description?t(\"div\",{staticClass:\"download-video-config-description\",domProps:{innerHTML:e._s(e.selectedOutput.description)}}):e._e(),e._v(\" \"),e.selectedOutput&&e.selectedOutput.component?t(e.selectedOutput.component,{ref:\"outputOptions\",tag:\"component\"}):e._e()],2),e._v(\" \"),t(\"div\",{staticClass:\"download-video-panel-footer\"},[t(\"VButton\",{staticClass:\"run-download\",attrs:{type:\"primary\",disabled:!e.canStartDownload},on:{click:function(t){return e.startDownload(e.$refs.outputOptions,e.selectedOutput)}}},[e._v(\"\\n      开始\\n    \")])],1)])};n._withStripped=!0;var o=i(905),s=i(847);const a=coreApis.utils.log;var d=i(82);const r=coreApis.ui,l=coreApis.pluginApis.data;var c=i(179);const u=coreApis.toast;var p=i(121),h=i(416),f=i(161),m=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"episodes-picker download-video-config-section\"},[t(\"div\",{staticClass:\"episodes-picker-header\"},[t(\"div\",{staticClass:\"episodes-picker-title\"},[e._v(\"选集:\")]),e._v(\" \"),t(\"div\",{staticClass:\"episodes-picker-checked-ratio\"},[e._v(\"\\n      \"+e._s(e.checkedRatio)+\"\\n    \")]),e._v(\" \"),t(\"div\",{staticClass:\"episodes-picker-actions\"},[t(\"VButton\",{staticClass:\"select-all\",attrs:{title:\"全选\",type:\"transparent\"},on:{click:function(t){e.forEachItem((e=>e.isChecked=!0))}}},[t(\"VIcon\",{attrs:{size:16,icon:\"mdi-checkbox-multiple-marked-circle\"}})],1),e._v(\" \"),t(\"VButton\",{staticClass:\"deselect-all\",attrs:{title:\"全不选\",type:\"transparent\"},on:{click:function(t){e.forEachItem((e=>e.isChecked=!1))}}},[t(\"VIcon\",{attrs:{size:16,icon:\"mdi-checkbox-multiple-blank-circle-outline\"}})],1),e._v(\" \"),t(\"VButton\",{staticClass:\"invert-selection\",attrs:{title:\"反选\",type:\"transparent\"},on:{click:function(t){e.forEachItem((e=>e.isChecked=!e.isChecked))}}},[t(\"VIcon\",{attrs:{size:16,icon:\"mdi-circle-slice-4\"}})],1)],1)]),e._v(\" \"),t(\"div\",{staticClass:\"episodes-picker-items\"},[0===e.episodeItems.length?t(\"div\",{staticClass:\"episodes-picker-empty\"},[t(\"VEmpty\")],1):e._e(),e._v(\" \"),e._l(e.episodeItems,(function(i,n){return t(\"div\",{key:i.key,staticClass:\"episodes-picker-item\"},[t(\"CheckBox\",{attrs:{\"icon-position\":\"left\",\"data-aid\":i.inputItem.aid,\"data-cid\":i.inputItem.cid,\"data-bvid\":i.inputItem.bvid},nativeOn:{click:function(t){return e.shiftSelect(t,i,n)}},model:{value:i.isChecked,callback:function(t){e.$set(i,\"isChecked\",t)},expression:\"item.isChecked\"}},[t(\"span\",{staticClass:\"episode-title\"},[e._v(\"\\n          \"+e._s(i.title)+\"\\n        \")]),e._v(\" \"),i.durationText?t(\"span\",{staticClass:\"episode-duration\"},[e._v(\"\\n          \"+e._s(i.durationText)+\"\\n        \")]):e._e()])],1)}))],2)])};m._withStripped=!0;const v=Vue.extend({components:{VButton:r.VButton,VIcon:r.VIcon,CheckBox:r.CheckBox,VEmpty:r.VEmpty},props:{api:{type:Function,required:!0}},data:()=>({episodeItems:[],maxCheckedItems:32,lastCheckedEpisodeIndex:-1}),computed:{checkedRatio(){return`(${this.episodeItems.filter((e=>e.isChecked)).length}/${this.episodeItems.length})`},inputItems(){return this.episodeItems.map((e=>e.inputItem))},checkedInputItems(){return this.episodeItems.filter((e=>e.isChecked)).map((e=>e.inputItem))}},created(){this.getEpisodeItems()},methods:{shiftSelect(e,t,i){e.shiftKey&&-1!==this.lastCheckedEpisodeIndex?e.shiftKey&&-1!==this.lastCheckedEpisodeIndex&&(this.episodeItems.slice(Math.min(this.lastCheckedEpisodeIndex,i)+1,Math.max(this.lastCheckedEpisodeIndex,i)).forEach((e=>{e.isChecked=!e.isChecked})),this.lastCheckedEpisodeIndex=i,e.preventDefault()):this.lastCheckedEpisodeIndex=i},forEachItem(e){this.episodeItems.forEach(e)},async getEpisodeItems(){this.episodeItems.length>0||(this.episodeItems=await this.api(this))}}});var g=i(991),b=i.n(g),y=i(174),w=i.n(y),x={insert:\"head\",singleton:!1};b()(w(),x);w().locals;var _=i(678);const k=(0,_.A)(v,m,[],!1,null,null,null).exports,I=e=>Vue.extend({computed:{checkedInputItems(){return this.$refs.picker.checkedInputItems}},render:t=>t(k,{props:{api:e},ref:\"picker\"})}),C={name:\"bangumi.batch\",displayName:\"当前番剧 (多P)\",match:f.bangumiUrls,batch:!0,getInputs:async e=>e?.checkedInputItems??[],component:async()=>I((async e=>{const t=dq('script[type=\"application/ld+json\"]');if(!t)return(0,a.logError)(\"获取番剧数据失败: 无法找到 Metadata\"),[];const i=JSON.parse(t.innerHTML.trim()),n=lodash.get(i,\"itemListElement.0.url\",null);if(null===n)return(0,a.logError)(\"获取番剧数据失败: 无法找到 metaUrl\"),[];const s=n.match(/play\\/ss(\\d+)/)?.[1];if(void 0===s)return(0,a.logError)(\"获取番剧数据失败: 无法解析 Season ID\"),[];const r=await(0,h.getJson)(`https://api.bilibili.com/pgc/web/season/section?season_id=${s}`);if(0!==r.code)return(0,a.logError)(`获取番剧数据失败: 无法获取番剧集数列表, message=${r.message}`),[];const l=[...r.result.main_section.episodes,...r.result.section?.flatMap((e=>e.episodes))??[]];return l.map((c=l.length,(t,i)=>{const n=t.long_title?t.title:(i+1).toString(),s=t.long_title?t.long_title:t.title;return{key:t.cid,title:`${n} - ${s}`,isChecked:i<e.maxCheckedItems,inputItem:{aid:t.aid,cid:t.cid,title:(0,p.formatTitle)((0,o.getGeneralSettings)().batchFilenameFormat,!1,{ep:s,cid:t.cid,aid:t.aid,n:(0,d.formatNumber)(parseFloat(n),c)??n}),allowQualityDrop:!0}}}));var c}))},A={name:\"video.batch\",displayName:\"当前视频 (多P)\",match:f.videoUrls,batch:!0,getInputs:async e=>e?.checkedInputItems??[],component:async()=>I((async e=>{const{aid:t}=unsafeWindow,i=`https://api.bilibili.com/x/web-interface/view?aid=${t}`,n=await(0,h.getJsonWithCredentials)(i);if(0!==n.code)return(0,a.logError)(`获取视频选集列表失败, message = ${n.message}`),[];const{pages:s,owner:r,pubdate:l}=n.data;if(void 0===s)return(0,a.logError)(\"获取视频选集列表失败, 没有找到选集信息.\"),[];const c=(0,p.getTitleVariablesFromDate)(new Date(1e3*l));return s.map(((i,n)=>({key:i.cid,title:`P${i.page} ${i.part}`,isChecked:n<e.maxCheckedItems,durationText:(0,d.formatDuration)(i.duration),inputItem:{allowQualityDrop:!0,title:(0,p.formatTitle)((0,o.getGeneralSettings)().batchFilenameFormat,!1,{n:(0,d.formatNumber)(i.page,s.length),cid:i.cid,ep:i.part,user:r?.name,userID:r?.mid?.toString(),publishYear:c.year,publishMonth:c.month,publishDay:c.day,publishHour:c.hour,publishMinute:c.minute,publishSecond:c.second,publishMillisecond:c.millisecond}),cid:i.cid,aid:t}})))}))},V={name:\"video.seasonBatch\",displayName:\"当前视频 (合集)\",match:f.videoUrls,batch:!0,getInputs:async e=>e?.checkedInputItems??[],component:async()=>I((async e=>{const{aid:t,bvid:i}=unsafeWindow,n=`https://api.bilibili.com/x/web-interface/wbi/view/detail?bvid=${i}&aid=${t}`,s=await(0,h.getJsonWithCredentials)(n);if(0!==s.code)return(0,a.logError)(`获取视频合集列表失败, message = ${s.message}`),[];const r=lodash.get(s,\"data.View.owner\",{}),l=lodash.get(s,\"data.View.ugc_season.sections\",[]);if(0===l.length)return[];const c=lodash.sumBy(l,(e=>e.episodes.length));return l.flatMap(((t,i)=>{const{episodes:n=[]}=t;return n.map(((t,n)=>{const s=n+lodash.sumBy(l.slice(0,i),(e=>e.episodes.length)),a=t.cid,u=s+1,h=`P${u} ${t.title}`,f=(0,p.getTitleVariablesFromDate)(new Date(1e3*t.arc.pubdate));return{key:a,title:h,isChecked:s<e.maxCheckedItems,durationText:(0,d.formatDuration)(t.arc.duration),inputItem:{allowQualityDrop:!0,title:(0,p.formatTitle)((0,o.getGeneralSettings)().batchFilenameFormat,!1,{n:(0,d.formatNumber)(u,c),title:t.page.part,cid:t.cid,aid:t.aid,bvid:t.bvid,ep:t.title,user:r.name,userID:r.mid?.toString(),publishYear:f.year,publishMonth:f.month,publishDay:f.day,publishHour:f.hour,publishMinute:f.minute,publishSecond:f.second,publishMillisecond:f.millisecond}),cid:t.cid,aid:t.aid}}}))}))}))},D={name:\"video\",displayName:\"当前视频\",match:f.videoUrls,getInputs:async()=>[{aid:unsafeWindow.aid,cid:unsafeWindow.cid,title:(0,p.getFriendlyTitle)(!0)}],component:()=>Promise.resolve().then(i.bind(i,586)).then((e=>e.default))};var S=i(385),E=i(849),O=i(882),U=i(84);const T=(e,t)=>{const i=e=>t.length>e?t[e]:t[t.length-1];return{fragments:e.durl.map(((e,t)=>({length:e.length,size:e.size,url:e.url,backupUrls:e.backup_url,extension:i(t)}))),qualities:e.accept_quality.map((e=>c.allQualities.find((t=>t.value===e)))).filter((e=>void 0!==e)),currentQuality:c.allQualities.find((t=>t.value===e.quality))}},$={name:\"video.flv\",displayName:\"flv\",description:\"使用 flv 格式下载, 兼容 H.264 编码. 支持的清晰度相比于 dash 会少很多.\",downloadVideoInfo:e=>(async e=>{const{aid:t,cid:i,quality:n}=e,o={avid:t,cid:i,qn:n?.value??\"\",otype:\"json\"},a=f.bangumiUrls.some((e=>(0,s.matchUrlPattern)(e))),d=a?(0,U.i)((0,s.formData)(o)):(0,U.y)((0,s.formData)(o)),r=await(0,h.bilibiliApi)((0,h.getJsonWithCredentials)(d),\"获取视频链接失败\"),l=new O._({input:e,jsonData:r,...T(r,[\".flv\"])});return(0,E.X)(e,l),l})(e)},j=coreApis.runtimeLibrary,P={name:\"steamSaver\",displayName:\"StreamSaver\",description:'使用 StreamSaver 输出到本地文件, 下载过程中请勿关闭页面. 注意: 需要浏览器允许来自 jimmywarting.github.io (StreamSaver 的网站) 的第三方 cookie, 详细原因见 <a href=\"https://github.com/jimmywarting/StreamSaver.js?#how-does-it-work\" target=\"blank\">How does it work</a>, 否则弹出的链接点击后会没有反应.',runAction:async e=>{const t=await j.StreamSaverLibrary,i=e.infos.flatMap((e=>e.titledFragments)),n=u.Toast.show(i.map(((e,t)=>`<a class=\"link\" data-index=\"${t}\">${e.title}</a>`)).join(\"\\n\"),\"下载视频\"),o=await n.element;dqa(o,\"a[data-index]\").forEach((e=>{e.addEventListener(\"click\",(async()=>{const{index:n}=e.dataset,{title:o,url:s,size:a}=i[n],d=t.createWriteStream(o,{size:a}),r=await fetch(s);await r.body.pipeTo(d)}))}))}},[q]=(0,l.registerAndGetData)(\"downloadVideo.inputs\",[D,A,V,C]),[N]=(0,l.registerAndGetData)(\"downloadVideo.apis\",[$,S.En,S.WO,S.E,S.EA]),[Q]=(0,l.registerAndGetData)(\"downloadVideo.assets\",[]),[B]=(0,l.registerAndGetData)(\"downloadVideo.outputs\",[P]),{basicConfig:M}=(0,o.getComponentSettings)(\"downloadVideo\").options,H=e=>e.filter((e=>e.match?.some((e=>(0,s.matchUrlPattern)(e)))??!0)),F=Vue.extend({components:{VPopup:r.VPopup,VButton:r.VButton,VDropdown:r.VDropdown,VIcon:r.VIcon,SwitchBox:r.SwitchBox},props:{triggerElement:{required:!0}},data(){const e=M.output,t=M.useBackupUrls;return{open:!1,busy:!1,testData:{videoInfo:null,multiple:!1},assets:Q,qualities:[],selectedQuality:void 0,inputs:[],selectedInput:void 0,apis:[],selectedApi:void 0,outputs:B,selectedOutput:B.find((t=>t.name===e))||B[0],useBackupUrls:t||!1}},computed:{assetsWithOptions(){return this.assets.filter((e=>e.component))},filteredQualities(){return 0===this.qualities.length?c.allQualities:this.qualities},canStartDownload(){if(this.busy||!this.open)return!1;return!Object.entries(this).filter((e=>{let[t]=e;return t.startsWith(\"selected\")})).some((e=>{let[,t]=e;return!t}))}},watch:{selectedInput(e){void 0!==e&&this.updateTestVideoInfo()},selectedApi(e){void 0!==e&&(this.updateTestVideoInfo(),M.api=e.name)},selectedOutput(e){void 0!==e&&(M.output=e.name)},useBackupUrls(e){void 0!==e&&(M.useBackupUrls=e)}},mounted(){coreApis.observer.videoChange((()=>{this.selectedInput=void 0,this.selectedApi=void 0;const e=H(q);this.inputs=e,this.selectedInput=e[0];const t=H(N);this.apis=t;const i=t.find((e=>e.name===M.api));this.selectedApi=i||t[0]}))},methods:{formatFileSize:d.formatFileSize,saveSelectedQuality(){const e=this.selectedQuality;void 0!==e&&(M.quality=e.value,this.updateTestVideoInfo())},async getVideoItems(){const e=this.selectedInput;return await e.getInputs(this.$refs.inputOptions)},async updateTestVideoInfo(){if(!this.selectedInput||!this.selectedApi)return;this.testData.videoInfo=null;const e=this.selectedInput,t=e.getTestInput?.()??{aid:unsafeWindow.aid,cid:unsafeWindow.cid,title:(0,p.getFriendlyTitle)(!0)};console.log(\"[updateTestVideoInfo]\",t),this.testData.multiple=e.batch;const i=this.selectedApi;try{const e=await i.downloadVideoInfo(t);this.qualities=e.qualities;if((!this.selectedQuality||!e.qualities.some((e=>e.value===this.selectedQuality.value)))&&(this.selectedQuality=e.qualities[0],M.quality)){const[t]=e.qualities.filter((e=>e.value<=M.quality));t&&(this.selectedQuality=t)}t.quality=this.selectedQuality;const n=await i.downloadVideoInfo(t);this.testData.videoInfo=n}catch(e){console.error(\"[updateTestVideoInfo] failed\",e),this.testData.videoInfo=void 0}},async startDownload(e,t){try{this.busy=!0;const i=this.selectedInput,n=this.selectedApi,o=await i.getInputs(this.$refs.inputOptions);if(0===o.length)return void u.Toast.info(\"未接收到视频, 如果输入源支持批量, 请至少选择一个视频.\",\"下载视频\",3e3);o.forEach((e=>{e.quality=this.selectedQuality}));const s=await Promise.all(o.map((e=>n.downloadVideoInfo(e))));if(0===s.length||0===lodash.sumBy(s,(e=>e.fragments.length)))return void u.Toast.info(\"未接收到可下载数据, 请检查输入源和格式是否适用于当前视频.\",\"下载视频\",3e3);this.useBackupUrls&&s.forEach((e=>{e.fragments.forEach((e=>{e.url=e.backupUrls&&0!==e.backupUrls.length?e.backupUrls.at(0):e.url}))}));const a=new O.C(s);Q.forEach((e=>{(e?.getUrls?a.extraOnlineAssets:a.extraAssets).push({asset:e,instance:this.$refs.assetsOptions.find((t=>t.$attrs.name===e.name))})})),await t.runAction(a,e),await a.downloadExtraAssets()}catch(e){(0,a.logError)(e)}finally{this.busy=!1}}}}),W=F;\n/* spell-checker: disable */var z=i(227),L=i.n(z),R={insert:\"head\",singleton:!1};b()(L(),R);L().locals;const G=(0,_.A)(W,n,[],!1,null,null,null).exports},448:(e,t,i)=>{\"use strict\";i.r(t),i.d(t,{default:()=>a});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"multiple-widgets\"},[t(\"DefaultWidget\",{ref:\"button\",attrs:{name:\"下载视频\",icon:\"mdi-download\"},on:{mouseover:function(t){return e.createDownloadPanel()},click:function(t){return e.toggleDownloadPanel()}}})],1)};let o;n._withStripped=!0;const s=Vue.extend({components:{DefaultWidget:coreApis.ui.DefaultWidget},methods:{async createDownloadPanel(){if(!o){const e=document.createElement(\"div\");document.body.appendChild(e);const t=await Promise.resolve().then(i.bind(i,14)).then((e=>e.default));o=new t({propsData:{triggerElement:this.$refs.button}}).$mount(e)}},async toggleDownloadPanel(){o&&(o.open=!o.open)}}});const a=(0,i(678).A)(s,n,[],!1,null,null,null).exports},586:(e,t,i)=>{\"use strict\";i.r(t),i.d(t,{default:()=>p});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"single-video-info download-video-config-section\"},[e.imageUrl?t(\"img\",{staticClass:\"shadow\",attrs:{src:e.imageUrl}}):e._e(),e._v(\" \"),e.imageUrl?t(\"img\",{attrs:{src:e.imageUrl}}):e._e()])};n._withStripped=!0;const o=coreApis.componentApis.video.videoCover,s=coreApis.observer,a=Vue.extend({data:()=>({imageUrl:\"\"}),created(){(0,s.videoChange)((async()=>{const{aid:e}=unsafeWindow;this.imageUrl=await(0,o.getVideoCoverUrlByAid)(e)}))}});var d=i(991),r=i.n(d),l=i(495),c=i.n(l),u={insert:\"head\",singleton:!1};r()(c(),u);c().locals;const p=(0,i(678).A)(a,n,[],!1,null,null,null).exports},678:(e,t,i)=>{\"use strict\";function n(e,t,i,n,o,s,a,d){var r,l=\"function\"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),s&&(l._scopeId=\"data-v-\"+s),a?(r=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=r):o&&(r=d?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),r)if(l.functional){l._injectStyles=r;var c=l.render;l.render=function(e,t){return r.call(t),c(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,r):[r]}return{exports:e,options:l}}i.d(t,{A:()=>n})},292:e=>{function t(e){var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}t.keys=()=>[],t.resolve=t,t.id=292,e.exports=t},623:e=>{\"use strict\";e.exports=\"在功能面板中添加下载视频支持. 请注意:\\n- 不能下载超出账号权限的视频, 例如非大会员下载大会员清晰度视频, 或者大陆地区网络下载港澳台地区番剧, 都是不可以的.\\n- 请勿短时间进行大量下载, 以免遭到 b 站 IP 封禁.\\n\\n在使用视频 (非番剧) 批量下载时, 文件的批量命名格式中可以使用以下额外变量:\\n- `user`: UP 主用户名\\n- `userID`: UP 主用户 ID\\n- 视频发布时间:\\n  - `publishYear`\\n  - `publishMonth`\\n  - `publishDay`\\n  - `publishHour`\\n  - `publishMinute`\\n  - `publishSecond`\\n  - `publishMillisecond`\\n\"},416:e=>{\"use strict\";e.exports=coreApis.ajax},179:e=>{\"use strict\";e.exports=coreApis.componentApis.video.videoQuality},905:e=>{\"use strict\";e.exports=coreApis.settings},82:e=>{\"use strict\";e.exports=coreApis.utils.formatters},121:e=>{\"use strict\";e.exports=coreApis.utils.title},161:e=>{\"use strict\";e.exports=coreApis.utils.urls},847:e=>{\"use strict\";e.exports=coreApis.utils}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={id:e,exports:{}};return i[e](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(i,n){if(1&n&&(i=this(i)),8&n)return i;if(\"object\"==typeof i&&i){if(4&n&&i.__esModule)return i;if(16&n&&\"function\"==typeof i.then)return i}var s=Object.create(null);o.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var d=2&n&&i;\"object\"==typeof d&&!~e.indexOf(d);d=t(d))Object.getOwnPropertyNames(d).forEach((e=>a[e]=()=>i[e]));return a.default=()=>i,o.d(s,a),s},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.nc=void 0;var s={};return(()=>{\"use strict\";o.d(s,{component:()=>a});const e=coreApis.componentApis.define,t=coreApis.spinQuery;var i=o(385);const n=(0,e.defineOptionsMetadata)({basicConfig:{defaultValue:{},displayName:\"基础配置\",hidden:!0},dashVideoExtension:{defaultValue:i.oD.video,displayName:\"DASH 视频扩展名\"},dashAudioExtension:{defaultValue:i.oD.audio,displayName:\"DASH 普通音频扩展名\"},dashFlacAudioExtension:{defaultValue:i.oD.flacAudio,displayName:\"DASH FLAC 音频扩展名\"},dashCodecFallback:{defaultValue:i.vx.Avc,dropdownEnum:i.vx,displayName:\"DASH 回退编码\"}}),a=(0,e.defineComponentMetadata)({name:\"downloadVideo\",displayName:\"下载视频\",entry:none,reload:none,unload:none,widget:{component:()=>Promise.resolve().then(o.bind(o,448)).then((e=>e.default)),condition:()=>(0,t.hasVideo)()},tags:[componentsTags.video],options:n,commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\",description:(()=>{const e=o(292);return{...Object.fromEntries(e.keys().map((t=>[t.match(/index\\.(.+)\\.md$/)[1],e(t)]))),\"zh-CN\":()=>Promise.resolve().then(o.t.bind(o,623,17)).then((e=>e.default))}})()})})(),s=s.component})()));",
      "metadata": {
        "name": "downloadVideo",
        "displayName": "下载视频",
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "options": {
          "basicConfig": {
            "defaultValue": {},
            "displayName": "基础配置",
            "hidden": true
          },
          "dashVideoExtension": {
            "defaultValue": ".mp4",
            "displayName": "DASH 视频扩展名"
          },
          "dashAudioExtension": {
            "defaultValue": ".m4a",
            "displayName": "DASH 普通音频扩展名"
          },
          "dashFlacAudioExtension": {
            "defaultValue": ".flac",
            "displayName": "DASH FLAC 音频扩展名"
          },
          "dashCodecFallback": {
            "defaultValue": "AVC/H.264",
            "dropdownEnum": {
              "Avc": "AVC/H.264",
              "Hevc": "HEVC/H.265",
              "Av1": "AV1"
            },
            "displayName": "DASH 回退编码"
          }
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1",
        "description": {}
      },
      "settings": {
        "enabled": true,
        "options": {
          "basicConfig": {
            "api": "video.dash.avc",
            "quality": 112
          },
          "dashVideoExtension": ".mp4",
          "dashAudioExtension": ".m4a",
          "dashFlacAudioExtension": ".flac",
          "dashCodecFallback": "AVC/H.264"
        }
      }
    },
    "videoScreenshot": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"video/player/screenshot\"]=t():e[\"video/player/screenshot\"]=t()}(globalThis,(()=>(()=>{var e,t,n={130:(e,t,n)=>{var i=n(955)((function(e){return e[1]}));i.push([e.id,'.video-screenshot-thumbnail {\\n  margin: var(--thumbnail-margin-vertical) var(--thumbnail-margin-horizontal);\\n  position: relative;\\n  transition: 0.35s cubic-bezier(0.18, 0.89, 0.32, 1.28);\\n  width: var(--screenshot-width);\\n  height: var(--screenshot-height);\\n  background-color: black;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n@keyframes spinner {\\nto {\\n    transform: translate(-50%, -50%) rotate(360deg);\\n}\\n}\\n.video-screenshot-thumbnail img {\\n  max-width: var(--screenshot-width);\\n  max-height: var(--screenshot-height);\\n  display: block;\\n  background-color: black;\\n}\\n.video-screenshot-thumbnail .loading::before {\\n  content: \"\";\\n  box-sizing: border-box;\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%) rotate(0deg);\\n  width: 24px;\\n  height: 24px;\\n  border-radius: 50%;\\n  border: 3px solid #8888;\\n  border-top-color: var(--theme-color);\\n  animation: spinner 0.6s linear infinite;\\n}\\n.video-screenshot-thumbnail.video-screenshot-list-leave-active {\\n  position: absolute;\\n  transition: 0.35s cubic-bezier(0.6, -0.28, 0.74, 0.05);\\n}\\n.video-screenshot-thumbnail .mask {\\n  position: absolute;\\n  opacity: 0;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  background: #0008;\\n  display: flex;\\n  justify-content: space-around;\\n  align-items: center;\\n  transition: none;\\n  pointer-events: none;\\n}\\n.video-screenshot-thumbnail .mask .time {\\n  color: #fff;\\n  position: absolute;\\n  bottom: 4px;\\n  left: 8px;\\n  font-size: 10pt;\\n}\\n.video-screenshot-thumbnail .mask button {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background: #000a;\\n  color: #fff;\\n  border: none;\\n  border-radius: 50%;\\n  font-size: 24pt;\\n  cursor: pointer;\\n  width: 48px;\\n  height: 48px;\\n  pointer-events: initial;\\n  outline: none !important;\\n}\\n.video-screenshot-thumbnail:hover .mask {\\n  opacity: 1;\\n}',\"\"]),e.exports=i},633:(e,t,n)=>{var i=n(955)((function(e){return e[1]}));i.push([e.id,\".video-screenshot-container {\\n  position: relative;\\n  --screenshot-width: 240px;\\n  --screenshot-width-negative: calc(0px - var(--screenshot-width));\\n  --screenshot-height: 135px;\\n  --thumbnail-margin-vertical: 12px;\\n  --thumbnail-margin-horizontal: 12px;\\n  --screenshot-list-width: calc(2 * var(--thumbnail-margin-horizontal) + var(--screenshot-width));\\n}\\n.video-screenshot-disable .video-screenshot-container {\\n  display: none;\\n}\\n.video-screenshot-container .video-screenshot-batch {\\n  position: fixed;\\n  bottom: var(--thumbnail-margin-vertical);\\n  right: var(--thumbnail-margin-horizontal);\\n  z-index: 20000;\\n  width: var(--screenshot-list-width);\\n  display: flex;\\n  align-items: center;\\n  gap: 16px;\\n  justify-content: space-between;\\n}\\n.video-screenshot-container .video-screenshot-batch button {\\n  background: #000c;\\n  color: #fff;\\n  border: none;\\n  border-radius: 8px;\\n  font-size: 14px;\\n  cursor: pointer;\\n  outline: 0 !important;\\n  padding: 8px 12px;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  justify-content: center;\\n  flex-grow: 1;\\n}\\n.video-screenshot-container .video-screenshot-batch button .be-icon {\\n  margin-right: 4px;\\n}\\n.video-screenshot-container .video-screenshot-list {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  z-index: 20000;\\n  margin: var(--thumbnail-margin-vertical) var(--thumbnail-margin-horizontal);\\n  max-height: calc(100% - 3 * var(--thumbnail-margin-vertical) - 37px);\\n  width: var(--screenshot-list-width);\\n  background-color: #000c;\\n  border-radius: 8px;\\n  overflow: auto;\\n  scrollbar-width: none !important;\\n  overscroll-behavior: contain;\\n}\\n.video-screenshot-container .video-screenshot-list::-webkit-scrollbar {\\n  height: 0 !important;\\n  width: 0 !important;\\n}\\n.video-screenshot-container .video-screenshot-list > * {\\n  pointer-events: initial;\\n}\\n.video-screenshot-container .video-screenshot-list-enter {\\n  opacity: 0;\\n  transform: translateX(var(--screenshot-width-negative));\\n}\\n.video-screenshot-container .video-screenshot-list-leave-to {\\n  opacity: 0;\\n  transform: translateX(var(--screenshot-width));\\n}\",\"\"]),e.exports=i},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?\"@media \".concat(t[2],\" {\").concat(n,\"}\"):n})).join(\"\")},\n// eslint-disable-next-line func-names\nt.i=function(e,n,i){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var o={};if(i)for(var r=0;r<this.length;r++){\n// eslint-disable-next-line prefer-destructuring\nvar s=this[r][0];null!=s&&(o[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&o[c[0]]||(n&&(c[2]?c[2]=\"\".concat(n,\" and \").concat(c[2]):c[2]=n),t.push(c))}},t}},991:(e,t,n)=>{\"use strict\";var i,o=function(){return void 0===i&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\ni=Boolean(window&&document&&document.all&&!window.atob)),i},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},i=[],o=0;o<e.length;o++){var r=e[o],c=t.base?r[0]+t.base:r[0],d=n[c]||0,l=\"\".concat(c,\" \").concat(d);n[c]=d+1;var h=a(l),u={css:r[1],media:r[2],sourceMap:r[3]};-1!==h?(s[h].references++,s[h].updater(u)):s.push({identifier:l,updater:f(u,t),references:1}),i.push(l)}return i}function d(e){var t=document.createElement(\"style\"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),\"function\"==typeof e.insert)e.insert(t);else{var s=r(e.insert||\"head\");if(!s)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");s.appendChild(t)}return t}var l,h=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join(\"\\n\")});function u(e,t,n,i){var o=n?\"\":i.media?\"@media \".concat(i.media,\" {\").concat(i.css,\"}\"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function p(e,t,n){var i=n.css,o=n.media,r=n.sourceMap;if(o?e.setAttribute(\"media\",o):e.removeAttribute(\"media\"),r&&\"undefined\"!=typeof btoa&&(i+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\" */\")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var v=null,m=0;function f(e,t){var n,i,o;if(t.singleton){var r=m++;n=v||(v=d(t)),i=u.bind(null,n,r,!1),o=u.bind(null,n,r,!0)}else n=d(t),i=p.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||\"boolean\"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],\"[object Array]\"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var o=a(n[i]);s[o].references--}for(var r=c(e,t),d=0;d<n.length;d++){var l=a(n[d]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}n=r}}}},241:e=>{\"use strict\";e.exports=coreApis.componentApis.video.playerAgent},765:e=>{\"use strict\";e.exports=coreApis.utils.log}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,exports:{}};return n[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if(\"object\"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&\"function\"==typeof n.then)return n}var r=Object.create(null);o.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;\"object\"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,o.d(r,s),r},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.nc=void 0;var r={};return(()=>{\"use strict\";o.d(r,{component:()=>z});const e=coreApis.componentApis.video.videoControlBar,t=coreApis.utils,n=coreApis.utils.urls;var i=o(241);const s=coreApis.utils.title;function a(e,t,n){return(t=function(e){var t=function(e,t){if(\"object\"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||\"default\");if(\"object\"!=typeof i)return i;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"==typeof t?t:t+\"\"}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c=document.createElement(\"canvas\");class d{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.video=e,this.videoTime=t,this.withDanmaku=n,a(this,\"mimeType\",\"image/png\"),a(this,\"url\",\"\"),a(this,\"blob\",void 0),a(this,\"timeStamp\",(new Date).getTime()),this.createUrl()}async createUrl(){const{logError:e}=await Promise.resolve().then(o.t.bind(o,765,23));if(this.withDanmaku){const e=dq(i.playerAgent.query.video.wrap.selector).getBoundingClientRect(),t=e.width/e.height;t>=this.video.videoWidth/this.video.videoHeight?(c.height=this.video.videoHeight,c.width=this.video.videoHeight*t):(c.width=this.video.videoWidth,c.height=this.video.videoWidth/t)}else c.width=this.video.videoWidth,c.height=this.video.videoHeight;const t=c.getContext(\"2d\");if(null===t)return void e(\"视频截图失败: canvas 未创建或创建失败.\");const n=(c.width-this.video.videoWidth)/2,r=(c.height-this.video.videoHeight)/2;if(t.drawImage(this.video,n,r),this.withDanmaku){const e=dq(\"canvas.bilibili-player-video-danmaku, canvas.dm-canvas\");null!==e&&t.drawImage(e,0,0,c.width,c.height)}try{c.toBlob((t=>{null!==t?(this.blob=t,this.url=URL.createObjectURL(t)):e(\"视频截图失败: 创建 blob 失败.\")}),this.mimeType)}catch(t){e(\"视频截图失败: 操作被浏览器阻止. 这通常发生于电影的试看片段, 请在正片尝试使用截图功能.\")}}get filename(){return`${(0,s.getFriendlyTitle)()} @${this.time.replace(/:/g,\"-\")} ${this.timeStamp.toString()}.png`}get id(){return this.videoTime.toString()+this.timeStamp.toString()}get time(){const e=Math.trunc(this.videoTime/3600).toString(),t=Math.trunc(this.videoTime/60).toString(),n=(this.videoTime%60).toFixed(2);return\"0\"===e?`${t.padStart(2,\"0\")}:${n.padStart(5,\"0\")}`:`${e}:${t.padStart(2,\"0\")}:${n.padStart(5,\"0\")}`}revoke(){URL.revokeObjectURL(this.url)}}const l=coreApis.componentApis.define;var h=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"video-screenshot-container\"},[t(\"transition-group\",{staticClass:\"video-screenshot-list\",attrs:{name:\"video-screenshot-list\",tag:\"div\"}},e._l(e.screenshots,(function(n){return t(\"VideoScreenshot\",{key:n.id,attrs:{screenshot:n},on:{discard:function(t){return e.discard(n)}}})})),1),e._v(\" \"),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showBatch,expression:\"showBatch\"}],staticClass:\"video-screenshot-batch\"},[t(\"button\",{on:{click:e.saveAll}},[t(\"VIcon\",{attrs:{size:18,icon:\"mdi-content-save\"}}),e._v(\"全部保存\")],1),e._v(\" \"),t(\"button\",{on:{click:e.discardAll}},[t(\"VIcon\",{attrs:{size:18,icon:\"mdi-delete-forever\"}}),e._v(\"全部丢弃\\n    \")],1)])],1)};h._withStripped=!0;const u=coreApis.download,p=coreApis.ui;var v=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"div\",{staticClass:\"video-screenshot-thumbnail\"},[e.objectUrl?t(\"img\",{attrs:{src:e.objectUrl}}):e._e(),e._v(\" \"),e.objectUrl?t(\"div\",{staticClass:\"mask\"},[t(\"a\",{ref:\"link\",staticClass:\"link\",staticStyle:{display:\"none\"},attrs:{target:\"_blank\",href:e.objectUrl,download:e.filename}}),e._v(\" \"),t(\"button\",{staticClass:\"save\",attrs:{title:\"保存\"},on:{click:e.save}},[t(\"VIcon\",{attrs:{size:28,icon:\"mdi-content-save-outline\"}})],1),e._v(\" \"),t(\"button\",{staticClass:\"copy\",attrs:{title:\"复制\"},on:{click:e.copy}},[t(\"VIcon\",{attrs:{size:24,icon:e.showCopyTip?\"mdi-check\":\"mdi-content-copy\"}})],1),e._v(\" \"),t(\"button\",{staticClass:\"discard\",attrs:{title:\"丢弃\"},on:{click:e.discard}},[t(\"VIcon\",{attrs:{size:28,icon:\"mdi-delete-forever-outline\"}})],1),e._v(\" \"),t(\"span\",{staticClass:\"time\"},[e._v(e._s(e.time))])]):t(\"div\",{staticClass:\"loading\",on:{click:e.discard}})])};v._withStripped=!0;const m=Vue.extend({components:{VIcon:p.VIcon},props:{screenshot:{type:d,required:!0}},data:()=>({showCopyTip:!1}),computed:{objectUrl(){return this.screenshot.url},filename(){return this.screenshot.filename},time(){return this.screenshot.time}},methods:{discard(){this.$emit(\"discard\")},async copy(){const e=this.screenshot;await navigator.clipboard.write([new ClipboardItem({[e.mimeType]:e.blob})]),this.showCopyTip=!0,setTimeout((()=>{this.showCopyTip=!1}),1e3)},save(){const e=this.$refs.link;e.addEventListener(\"click\",(e=>{e.stopPropagation()}),{capture:!0,once:!0}),e.click(),this.discard()}}});var f=o(991),b=o.n(f),g=o(130),y=o.n(g),w={insert:\"head\",singleton:!1};b()(y(),w);y().locals;function x(e,t,n,i,o,r,s,a){var c,d=\"function\"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),i&&(d.functional=!0),r&&(d._scopeId=\"data-v-\"+r),s?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},d._ssrRegister=c):o&&(c=a?function(){o.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:o),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(e,t){return c.call(t),l(e,t)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,c):[c]}return{exports:e,options:d}}const k=x(m,v,[],!1,null,null,null).exports,_=Vue.extend({components:{VIcon:p.VIcon,VideoScreenshot:k},data:()=>({screenshots:[]}),computed:{showBatch(){return this.screenshots.length>=2}},methods:{discard(e){this.screenshots.splice(this.screenshots.indexOf(e),1),e.revoke()},async saveAll(){const e=new u.DownloadPackage;this.screenshots.forEach((t=>{e.add(t.filename,t.blob,{date:new Date(t.timeStamp)})})),await e.emit(`${(0,s.getFriendlyTitle)()}.zip`),this.discardAll()},discardAll(){this.screenshots.forEach((e=>e.revoke())),this.screenshots=[]}}});var C=o(633),S=o.n(C),j={insert:\"head\",singleton:!1};b()(S(),j);S().locals;const T=x(_,h,[],!1,null,null,null).exports,A=\"video-screenshot-disable\";let E;const O=e=>{E?.screenshots.length>0&&e.preventDefault()},z=(0,l.defineComponentMetadata)({name:\"videoScreenshot\",displayName:\"启用视频截图\",tags:[componentsTags.video],entry:async()=>{(0,e.addControlBarButton)({name:\"takeScreenshot\",displayName:\"截图\",icon:\"mdi-camera\",order:0,action:async e=>{const{playerAgent:n}=await Promise.resolve().then(o.t.bind(o,241,23)),i=await n.query.video.element();if(i instanceof HTMLVideoElement){const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.currentTime;return new d(e,n,t)}(i,e.shiftKey);E||(E=(0,t.mountVueComponent)(T),document.body.insertAdjacentElement(\"beforeend\",E.$el)),E.screenshots.unshift(n)}else{const{logError:e}=await Promise.resolve().then(o.t.bind(o,765,23));e(\"视频截图失败: 无法定位视频元素, 请尝试右击视频两次后另存为图片, 或将播放策略改为 AV1 或 AVC.\")}}}),window.addEventListener(\"beforeunload\",O)},description:{\"zh-CN\":\"启用视频快速截图, 将在播放器的时间右边增加一个截图按钮. 装有 `快捷键扩展` 时支持键盘快捷键<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd>.\"},urlInclude:n.playerUrls,reload:()=>{document.body.classList.remove(A),window.addEventListener(\"beforeunload\",O)},unload:()=>{document.body.classList.add(A),window.removeEventListener(\"beforeunload\",O)},plugin:{displayName:\"视频截图 - 快捷键支持\",setup:e=>{let{addData:t}=e;t(\"keymap.actions\",(e=>{e.takeScreenshot={displayName:\"视频截图\",run:e=>{const{clickElement:t}=e;return t('.be-video-control-bar-extend [data-name=\"takeScreenshot\"]',e)}}})),t(\"keymap.presets\",(e=>{e.takeScreenshot=\"ctrl [shift] alt c\"}))}},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"})})(),r=r.component})()));",
      "metadata": {
        "name": "videoScreenshot",
        "displayName": "启用视频截图",
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "description": {
          "zh-CN": "启用视频快速截图, 将在播放器的时间右边增加一个截图按钮. 装有 `快捷键扩展` 时支持键盘快捷键<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd>."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "seekByFrames": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"video/player/seek-by-frames\"]=t():e[\"video/player/seek-by-frames\"]=t()}(globalThis,(()=>(()=>{\"use strict\";var e,t,r={241:e=>{e.exports=coreApis.componentApis.video.playerAgent}},o={};function n(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return r[e](a,a.exports,n),a.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if(\"object\"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&\"function\"==typeof r.then)return r}var a=Object.create(null);n.r(a);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&o&&r;\"object\"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(a,s),a},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};n.d(a,{component:()=>m});const s=coreApis.componentApis.video.videoControlBar,i=coreApis.observer,l=coreApis.utils,c=coreApis.utils.urls,d=coreApis.pluginApis.data,p=coreApis.componentApis.define,u=\"seek-by-frame-disable\",m=(0,p.defineComponentMetadata)({name:\"seekByFrames\",displayName:\"启用逐帧调整\",tags:[componentsTags.video],description:{\"zh-CN\":\"在播放器的时间右边增加两个按钮, 用于**较精细**调整视频时间. 装有 `快捷键扩展` 时支持键盘快捷键<kbd>Shift</kbd>+<kbd>←</kbd>/<kbd>→</kbd>.\\n\\n> 注: `视频的实际播放帧率`跟`视频本身的帧率`和`显示器的刷新率`有关, 很难计算一个精准的数值, 部分视频仍然会有暂停不到那种一闪而过的图的情况.\"},entry:async()=>{await(0,l.playerReady)();const{playerAgent:e}=await Promise.resolve().then(n.t.bind(n,241,23));(0,d.addData)(\"ui.icons\",(e=>{e[\"seek-left\"]='<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n\\x3c!-- Generator: Adobe Illustrator 24.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\\x3e\\n<svg version=\"1.1\" id=\"图层_2_1_\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\"\\n\\t y=\"0px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;\" xml:space=\"preserve\">\\n<g>\\n\\t<path d=\"M15.5,20.3c-0.4,0-0.7-0.1-1-0.4l-8.3-7.5c-0.3-0.3-0.5-0.7-0.5-1.1c0-0.4,0.2-0.8,0.5-1.1l8.3-7.5\\n\\t\\tc0.6-0.6,1.6-0.5,2.1,0.1c0.6,0.6,0.5,1.6-0.1,2.1l-7.1,6.3l7.1,6.4c0.6,0.6,0.7,1.5,0.1,2.1C16.3,20.2,15.9,20.3,15.5,20.3z\"/>\\n</g>\\n<circle cx=\"16.8\" cy=\"11.3\" r=\"2.4\"/>\\n</svg>\\n',e[\"seek-right\"]='<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n\\x3c!-- Generator: Adobe Illustrator 24.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\\x3e\\n<svg version=\"1.1\" id=\"图层_2\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\\n\\t viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;\" xml:space=\"preserve\">\\n<g>\\n\\t<path d=\"M8.2,20.3c0.4,0,0.7-0.1,1-0.4l8.3-7.5c0.3-0.3,0.5-0.7,0.5-1.1c0-0.4-0.2-0.8-0.5-1.1L9.2,2.7C8.6,2.2,7.7,2.2,7.1,2.9\\n\\t\\tC6.6,3.5,6.6,4.4,7.3,5l7.1,6.3l-7.1,6.4c-0.6,0.6-0.7,1.5-0.1,2.1C7.4,20.2,7.8,20.3,8.2,20.3z\"/>\\n</g>\\n<circle cx=\"7\" cy=\"11.3\" r=\"2.4\"/>\\n</svg>\\n'}));let t=0;(0,i.attributesSubtree)(`${e.query.control.buttons.quality.selector} ul`,(()=>{const r=dq(`${e.query.control.buttons.quality.selector} .bui-select-item-active, ${e.query.control.buttons.quality.selector} .active`),o=r?parseInt(r.getAttribute(\"data-value\")):0,n=(()=>{switch(o){case 116:case 74:return 6e4/1001;default:return 3e4/1001}})();t=1/n}));const r=r=>{e.changeTime(r*t)};(0,s.addControlBarButton)({name:\"seekPrevFrame\",displayName:\"上一帧\",icon:\"seek-left\",order:1,action:()=>{r(-1)}}),(0,s.addControlBarButton)({name:\"seekNextFrame\",displayName:\"下一帧\",icon:\"seek-right\",order:2,action:()=>{r(1)}})},reload:()=>document.body.classList.remove(u),unload:()=>document.body.classList.add(u),urlInclude:c.playerUrls,plugin:{displayName:\"逐帧调整 - 快捷键支持\",setup:()=>{(0,d.addData)(\"keymap.actions\",(e=>{e.previousFrame={displayName:\"上一帧\",run:e=>{const{clickElement:t}=e;return t('.be-video-control-bar-extend [data-name=\"seekPrevFrame\"]',e)}},e.nextFrame={displayName:\"下一帧\",run:e=>{const{clickElement:t}=e;return t('.be-video-control-bar-extend [data-name=\"seekNextFrame\"]',e)}}})),(0,d.addData)(\"keymap.presets\",(e=>{e.previousFrame=\"shift arrowLeft\",e.nextFrame=\"shift arrowRight\"}))}},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"});return a=a.component})()));",
      "metadata": {
        "name": "seekByFrames",
        "displayName": "启用逐帧调整",
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "description": {
          "zh-CN": "在播放器的时间右边增加两个按钮, 用于**较精细**调整视频时间. 装有 `快捷键扩展` 时支持键盘快捷键<kbd>Shift</kbd>+<kbd>←</kbd>/<kbd>→</kbd>.\n\n> 注: `视频的实际播放帧率`跟`视频本身的帧率`和`显示器的刷新率`有关, 很难计算一个精准的数值, 部分视频仍然会有暂停不到那种一闪而过的图的情况."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "seoRedirect": {
      "code": "!function(e,o){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=o():\"function\"==typeof define&&define.amd?define([],o):\"object\"==typeof exports?exports[\"video/seo-redirect\"]=o():e[\"video/seo-redirect\"]=o()}(globalThis,(()=>(()=>{\"use strict\";var e={d:(o,t)=>{for(var i in t)e.o(t,i)&&!e.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:t[i]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)},o={};e.d(o,{component:()=>t});const t=(0,coreApis.componentApis.define.defineComponentMetadata)({name:\"seoRedirect\",displayName:\"SEO 页面重定向\",entry:()=>{window.location.assign(document.URL.replace(\"/s/\",\"/\"))},urlInclude:[\"//www.bilibili.com/s/video/\"],tags:[componentsTags.video],description:{\"zh-CN\":\"进入 SEO 视频页面时 (`https://www.bilibili.com/s/video/`) 自动跳转到原视频页面.\"},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"});return o=o.component})()));",
      "metadata": {
        "name": "seoRedirect",
        "displayName": "SEO 页面重定向",
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "description": {
          "zh-CN": "进入 SEO 视频页面时 (`https://www.bilibili.com/s/video/`) 自动跳转到原视频页面."
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "downloadSubtitle": {
      "code": "!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports[\"video/subtitle/download\"]=e():t[\"video/subtitle/download\"]=e()}(globalThis,(()=>(()=>{var t,e,n={427:(t,e,n)=>{\"use strict\";n.d(e,{Dl:()=>a});const o=coreApis.ajax;var i=n(5),r=n(121);const a=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{...lodash.pick(unsafeWindow,\"aid\",\"cid\"),title:(0,r.getFriendlyTitle)(!0)};const{aid:a,cid:s}=e;if(!a||!s)throw new Error(\"未找到视频AID和CID\");const l=await(async(t,e)=>{const n=await(0,o.bilibiliApi)((0,o.getJsonWithCredentials)(`https://api.bilibili.com/x/player/wbi/v2?aid=${t}&cid=${e}`));return lodash.get(n,\"subtitle.subtitles\",[])})(a,s);if(0===l.length)return i.Toast.info(\"当前视频没有字幕.\",\"下载字幕\",3e3),null;const[c,d]=await(async()=>{const{SubtitleConverter:t,SubtitleSize:e,SubtitleLocation:o}=await Promise.resolve().then(n.bind(n,722)),{playerAgent:i}=await Promise.resolve().then(n.t.bind(n,241,23)),a=i.getPlayerConfig(\"subtitle\",null);if(!a)return[t.defaultConfig,\"\"];const s=a.lan,l=(0,r.getFriendlyTitle)(!0),c={.6:e.VerySmall,.8:e.Small,1:e.Medium,1.3:e.Large,1.6:e.VeryLarge}[a.fontsize],d=parseInt(a.color).toString(16),{opacity:u}=a,f={bc:o.BottomCenter,bl:o.BottomLeft,br:o.BottomRight,tc:o.TopCenter,tl:o.TopLeft,tr:o.TopRight,\"bottom-center\":o.BottomCenter,\"bottom-left\":o.BottomLeft,\"bottom-right\":o.BottomRight,\"top-center\":o.TopCenter,\"top-left\":o.TopLeft,\"top-right\":o.TopRight}[a.position],p=i.query.video.element.sync();return[{title:l,height:p.videoHeight,width:p.videoWidth,color:d,location:f,opacity:u,size:c,boxPadding:1,boxMargin:32},s]})(),u=l.find((t=>t.lan===d))||l[0],f=(await(0,o.getJson)(u.subtitle_url)).body;if(\"ass\"===t){const{SubtitleConverter:t}=await Promise.resolve().then(n.bind(n,722)),o=new t({...c,title:e.title}),i=await o.convertToAss(f);return new Blob([i],{type:\"text/ass\"})}return new Blob([JSON.stringify(f,void 0,2)],{type:\"text/json\"})}},722:(t,e,n)=>{\"use strict\";function o(t,e,n){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||\"default\");if(\"object\"!=typeof o)return o;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:e+\"\"}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{SubtitleConverter:()=>a,SubtitleLocation:()=>i,SubtitleSize:()=>r});const i={TopLeft:7,TopCenter:8,TopRight:9,BottomLeft:1,BottomCenter:2,BottomRight:3};let r=function(t){return t[t.VerySmall=1]=\"VerySmall\",t[t.Small=2]=\"Small\",t[t.Medium=3]=\"Medium\",t[t.Large=4]=\"Large\",t[t.VeryLarge=5]=\"VeryLarge\",t}({});class a{constructor(t){o(this,\"config\",void 0),this.config=Object.assign(a.defaultConfig,t)}async getAssMeta(){const{convertHexColorForStyle:t}=await Promise.resolve().then(n.t.bind(n,381,23)),e=t(this.config.color),o=t(\"#000000\",this.config.opacity),r=[],a=(10*(this.config.size-3)+48)*this.config.height/720;console.log(a);for(const[t,n]of Object.entries(i))r.push(`Style: ${t},微软雅黑,${a},${e},${e},${o},${o},0,0,0,0,100,100,0,0,3,${this.config.boxPadding},0,${n},${this.config.boxMargin},${this.config.boxMargin},${this.config.boxMargin},0`);return`\\n[Script Info]\\n; Script generated by Bilibili Evolved Danmaku Converter\\n; https://github.com/the1812/Bilibili-Evolved/\\nTitle: ${this.config.title}\\nScriptType: v4.00+\\nPlayResX: ${this.config.width}\\nPlayResY: ${this.config.height}\\nTimer: 10.0000\\nWrapStyle: 0\\nScaledBorderAndShadow: no\\n\\n[V4+ Styles]\\nFormat: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding\\n${r.join(\"\\n\")}\\n\\n[Events]\\nFormat: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text`.trim()}async convertToAss(t){const{convertTimeByEndTime:e,normalizeContent:o}=await Promise.resolve().then(n.t.bind(n,381,23));return`${await this.getAssMeta()}\\n${t.map((t=>{const[n,r]=e(t.from,t.to);var a;return`Dialogue: 0,${n},${r},${a=this.config.location,Object.entries(i).filter((t=>{let[,e]=t;return e===a})).map((t=>{let[e]=t;return e})).shift()},,0,0,0,,${o(t.content)}`})).join(\"\\n\")}`}}o(a,\"defaultConfig\",void 0),a.defaultConfig={title:\"\",color:\"#ffffff\",width:1920,height:1080,size:r.Medium,opacity:.5,location:i.BottomCenter,boxPadding:1,boxMargin:32}},677:(t,e,n)=>{var o=n(955)((function(t){return t[1]}));o.push([t.id,\".download-subtitle-config.download-video-config-section .be-dropdown {\\n  text-transform: uppercase;\\n}\",\"\"]),t.exports=o},955:t=>{\"use strict\";\n// eslint-disable-next-line func-names\nt.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?\"@media \".concat(e[2],\" {\").concat(n,\"}\"):n})).join(\"\")},\n// eslint-disable-next-line func-names\ne.i=function(t,n,o){\"string\"==typeof t&&(\n// eslint-disable-next-line no-param-reassign\nt=[[null,t,\"\"]]);var i={};if(o)for(var r=0;r<this.length;r++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[r][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);o&&i[l[0]]||(n&&(l[2]?l[2]=\"\".concat(n,\" and \").concat(l[2]):l[2]=n),e.push(l))}},e}},991:(t,e,n)=>{\"use strict\";var o,i=function(){return void 0===o&&(\n// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n// @see https://github.com/webpack-contrib/style-loader/issues/177\no=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),a=[];function s(t){for(var e=-1,n=0;n<a.length;n++)if(a[n].identifier===t){e=n;break}return e}function l(t,e){for(var n={},o=[],i=0;i<t.length;i++){var r=t[i],l=e.base?r[0]+e.base:r[0],c=n[l]||0,d=\"\".concat(l,\" \").concat(c);n[l]=c+1;var u=s(d),f={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(a[u].references++,a[u].updater(f)):a.push({identifier:d,updater:v(f,e),references:1}),o.push(d)}return o}function c(t){var e=document.createElement(\"style\"),o=t.attributes||{};if(void 0===o.nonce){var i=n.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),\"function\"==typeof t.insert)t.insert(e);else{var a=r(t.insert||\"head\");if(!a)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");a.appendChild(e)}return e}var d,u=(d=[],function(t,e){return d[t]=e,d.filter(Boolean).join(\"\\n\")});function f(t,e,n,o){var i=n?\"\":o.media?\"@media \".concat(o.media,\" {\").concat(o.css,\"}\"):o.css;if(t.styleSheet)t.styleSheet.cssText=u(e,i);else{var r=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}function p(t,e,n){var o=n.css,i=n.media,r=n.sourceMap;if(i?t.setAttribute(\"media\",i):t.removeAttribute(\"media\"),r&&\"undefined\"!=typeof btoa&&(o+=\"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\" */\")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var m=null,g=0;function v(t,e){var n,o,i;if(e.singleton){var r=g++;n=m||(m=c(e)),o=f.bind(null,n,r,!1),i=f.bind(null,n,r,!0)}else n=c(e),o=p.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||\"boolean\"==typeof e.singleton||(e.singleton=i());var n=l(t=t||[],e);return function(t){if(t=t||[],\"[object Array]\"===Object.prototype.toString.call(t)){for(var o=0;o<n.length;o++){var i=s(n[o]);a[i].references--}for(var r=l(t,e),c=0;c<n.length;c++){var d=s(n[c]);0===a[d].references&&(a[d].updater(),a.splice(d,1))}n=r}}}},740:(t,e,n)=>{\"use strict\";n.r(e),n.d(e,{default:()=>u});var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(\"div\",{staticClass:\"multiple-widgets\"},[e(\"DefaultWidget\",{attrs:{disabled:t.disabled,name:\"下载字幕 (JSON)\",icon:\"subtitle\"},on:{click:function(e){return t.download(\"json\")}}}),t._v(\" \"),e(\"DefaultWidget\",{attrs:{disabled:t.disabled,name:\"下载字幕 (ASS)\",icon:\"subtitle\"},on:{click:function(e){return t.download(\"ass\")}}})],1)};o._withStripped=!0;const i=coreApis.pluginApis.data;var r=n(164);const a=coreApis.utils.log;var s=n(121);const l=coreApis.download;var c=n(427);(0,i.addData)(\"ui.icons\",(t=>{t.subtitle='<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 22 22\"><path d=\"M4 4h14a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2zm5 5.5a1 1 0 100-2H6a2 2 0 00-2 2v3a2 2 0 002 2h3a1 1 0 000-2H7a1 1 0 01-1-1v-1a1 1 0 011-1h2zm8 0a1 1 0 000-2h-3a2 2 0 00-2 2v3a2 2 0 002 2h3a1 1 0 000-2h-2a1 1 0 01-1-1v-1a1 1 0 011-1h2z\" fill-rule=\"evenodd\"/></svg>'}));const d=Vue.extend({components:{DefaultWidget:r.DefaultWidget},data:()=>({disabled:!1}),methods:{async download(t){try{this.disabled=!0;const e=await(0,c.Dl)(t);l.DownloadPackage.single(`${(0,s.getFriendlyTitle)(!0)}.${t}`,e)}catch(t){(0,a.logError)(t)}finally{this.disabled=!1}}}});const u=(0,n(678).A)(d,o,[],!1,null,null,null).exports},800:(t,e,n)=>{\"use strict\";n.r(e),n.d(e,{default:()=>p});var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(\"div\",{staticClass:\"download-subtitle-config download-video-config-section\"},[e(\"div\",{staticClass:\"download-video-config-item\"},[e(\"div\",{staticClass:\"download-video-config-title\"},[t._v(\"字幕:\")]),t._v(\" \"),e(\"VDropdown\",{attrs:{items:t.items},scopedSlots:t._u([{key:\"item\",fn:function({item:e}){return[t._v(\"\\n        \"+t._s(e)+\"\\n      \")]}}]),model:{value:t.type,callback:function(e){t.type=e},expression:\"type\"}})],1)])};o._withStripped=!0;const i=coreApis.settings;var r=n(164);const a=(0,i.getComponentSettings)(\"downloadVideo\").options,s=Vue.extend({components:{VDropdown:r.VDropdown},data:()=>({type:a.subtitleType??\"无\",items:[\"无\",\"ass\",\"json\"]}),computed:{enabled(){return\"无\"!==this.type}},watch:{type(t){a.subtitleType=t}}});var l=n(991),c=n.n(l),d=n(677),u=n.n(d),f={insert:\"head\",singleton:!1};c()(u(),f);u().locals;const p=(0,n(678).A)(s,o,[],!1,null,null,null).exports},678:(t,e,n)=>{\"use strict\";function o(t,e,n,o,i,r,a,s){var l,c=\"function\"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),r&&(c._scopeId=\"data-v-\"+r),a?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):i&&(l=s?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}n.d(e,{A:()=>o})},215:t=>{function e(t){var e=new Error(\"Cannot find module '\"+t+\"'\");throw e.code=\"MODULE_NOT_FOUND\",e}e.keys=()=>[],e.resolve=e,e.id=215,t.exports=e},76:t=>{\"use strict\";t.exports=\"启用下载字幕支持, 在视频页面中可从功能面板里下载字幕. (AI 生成的不可下载)\\n\"},381:t=>{\"use strict\";t.exports=coreApis.componentApis.video.assUtils},241:t=>{\"use strict\";t.exports=coreApis.componentApis.video.playerAgent},5:t=>{\"use strict\";t.exports=coreApis.toast},164:t=>{\"use strict\";t.exports=coreApis.ui},121:t=>{\"use strict\";t.exports=coreApis.utils.title}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var r=o[t]={id:t,exports:{}};return n[t](r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if(\"object\"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&\"function\"==typeof n.then)return n}var r=Object.create(null);i.r(r);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&o&&n;\"object\"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>n[t]));return a.default=()=>n,i.d(r,a),r},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.nc=void 0;var r={};return(()=>{\"use strict\";i.d(r,{component:()=>s});const t=coreApis.componentApis.define,e=coreApis.spinQuery;var n=i(5);const o=coreApis.utils.urls;var a=i(427);const s=(0,t.defineComponentMetadata)({name:\"downloadSubtitle\",displayName:\"下载字幕\",tags:[componentsTags.video],entry:none,urlInclude:o.videoAndBangumiUrls,widget:{condition:e.hasVideo,component:()=>Promise.resolve().then(i.bind(i,740)).then((t=>t.default))},plugin:{displayName:\"下载视频 - 下载字幕支持\",setup:t=>{let{addData:e}=t;e(\"downloadVideo.assets\",(async t=>{t.push({name:\"downloadSubtitles\",displayName:\"下载字幕\",getAssets:async(t,e)=>{const{type:o,enabled:i}=e;if(!i)return[];const r=n.Toast.info(\"获取字幕中...\",\"下载字幕\");let s=0;const l=await Promise.allSettled(t.map((async e=>{const n=await(0,a.Dl)(o,e.input);return s++,r.message=`获取字幕中... (${s}/${t.length})`,{name:`${e.input.title}.${o}`,data:n}}))),c=l.filter((t=>\"fulfilled\"===t.status)),d=l.filter((t=>\"rejected\"===t.status));return r.message=`获取完成. 成功 ${c.length} 个, 失败 ${d.length} 个.`,c.map((t=>t.value))},component:()=>Promise.resolve().then(i.bind(i,800)).then((t=>t.default))})}))}},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\",description:(()=>{const t=i(215);return{...Object.fromEntries(t.keys().map((e=>[e.match(/index\\.(.+)\\.md$/)[1],t(e)]))),\"zh-CN\":()=>Promise.resolve().then(i.t.bind(i,76,17)).then((t=>t.default))}})()})})(),r=r.component})()));",
      "metadata": {
        "name": "downloadSubtitle",
        "displayName": "下载字幕",
        "tags": [
          {
            "name": "video",
            "displayName": "视频",
            "color": "#2196F3",
            "icon": "mdi-play-circle-outline",
            "order": 1
          }
        ],
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1",
        "description": {}
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "hide-fullscreen-gift-bar": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"live/hide-gift-fullscreen\"]=t():e[\"live/hide-gift-fullscreen\"]=t()}(globalThis,(()=>(()=>{var e,t,n={558:(e,t,n)=>{var o=n(955)((function(e){return e[1]}));o.push([e.id,\"#full-screen-interactive-wrap { \\n    display: none !important \\n}\\n\\n#fullscreen-danmaku-vm .fullscreen-danmaku { \\n    bottom: 5px !important \\n}\",\"\"]),e.exports=o},955:e=>{\"use strict\";\n// eslint-disable-next-line func-names\ne.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?\"@media \".concat(t[2],\" {\").concat(n,\"}\"):n})).join(\"\")},\n// eslint-disable-next-line func-names\nt.i=function(e,n,o){\"string\"==typeof e&&(\n// eslint-disable-next-line no-param-reassign\ne=[[null,e,\"\"]]);var r={};if(o)for(var i=0;i<this.length;i++){\n// eslint-disable-next-line prefer-destructuring\nvar a=this[i][0];null!=a&&(r[a]=!0)}for(var c=0;c<e.length;c++){var s=[].concat(e[c]);o&&r[s[0]]||(n&&(s[2]?s[2]=\"\".concat(n,\" and \").concat(s[2]):s[2]=n),t.push(s))}},t}},980:(e,t,n)=>{var o=n(558);o&&o.__esModule&&(o=o.default),e.exports=\"string\"==typeof o?o:o.toString()}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={id:e,exports:{}};return n[e](i,i.exports,r),i.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if(\"object\"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&\"function\"==typeof n.then)return n}var i=Object.create(null);r.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var c=2&o&&n;\"object\"==typeof c&&!~e.indexOf(c);c=t(c))Object.getOwnPropertyNames(c).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(i,a),i},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};return(()=>{\"use strict\";r.d(i,{component:()=>n});const e=coreApis.componentApis.define,t=coreApis.utils.urls,n=(0,e.defineComponentMetadata)({name:\"hide-fullscreen-gift-bar\",displayName:\"全屏直播礼物简化\",description:\"移除全屏观看直播时的底部礼物栏\",author:{name:\"TimmyOVO\",link:\"https://github.com/TimmyOVO\"},instantStyles:[{name:\"hide-fullscreen-gift\",style:()=>Promise.resolve().then(r.t.bind(r,980,23))}],entry:none,tags:[componentsTags.live,componentsTags.style],urlInclude:t.liveUrls,commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\"})})(),i=i.component})()));",
      "metadata": {
        "name": "hide-fullscreen-gift-bar",
        "displayName": "全屏直播礼物简化",
        "description": "移除全屏观看直播时的底部礼物栏",
        "author": {
          "name": "TimmyOVO",
          "link": "https://github.com/TimmyOVO"
        },
        "tags": [
          {
            "name": "live",
            "displayName": "直播",
            "color": "#26A69A",
            "icon": "mdi-video-wireless-outline",
            "order": 4
          },
          {
            "name": "style",
            "displayName": "样式",
            "color": "#8BC34A",
            "icon": "mdi-palette-outline",
            "order": 2
          }
        ],
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1"
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "activeVideoLinks": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"utils/active-video-links\"]=t():e[\"utils/active-video-links\"]=t()}(globalThis,(()=>(()=>{var e,t,o={642:e=>{function t(e){var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}t.keys=()=>[],t.resolve=t,t.id=642,e.exports=t},401:e=>{\"use strict\";e.exports=\"这个组件会将视频简介中的普通网址转换为可点击的链接，并将<del>被 Bilibili 抛弃</del>已失效的 `acg.tv` 跳转链接修复为 `nicovideo.jp` 链接。\\n\\n例如: `https://acg.tv/sm37507315` → `https://www.nicovideo.jp/watch/sm37507315`\\n\\n<i>本组件不会保证目标链接的安全性，因此在点击前请自行验证其是否可信</i>\\n\"}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var c=n[e]={exports:{}};return o[e](c,c.exports,r),c.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if(\"object\"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&\"function\"==typeof o.then)return o}var c=Object.create(null);r.r(c);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&n&&o;\"object\"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>o[e]));return i.default=()=>o,r.d(c,i),c},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var c={};return(()=>{\"use strict\";r.d(c,{component:()=>a});const e=coreApis.componentApis.define,t=coreApis.utils.log,o=coreApis.utils.urls,n=(0,t.useScopedConsole)(\"activeVideoLinks\");let i=null;const l=/(?<!(\\>|'|\"|\\/))(http:\\/\\/|https:\\/\\/|www\\.)[^(\\s,;())]+/g,s=()=>{try{document.querySelectorAll('a[href*=\"acg.tv\"][href*=\"sm\"]').forEach((e=>{const t=e.getAttribute(\"href\");if(t){const o=t.replace(\"acg.tv\",\"nicovideo.jp/watch\");e.setAttribute(\"href\",o),n.log(`Niconico Fix: ${t} → ${o}`)}})),(()=>{const e=document.querySelector(\".desc-info-text\");if(!e)return;const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>e.parentElement?.closest(\"a\")?NodeFilter.FILTER_REJECT:l.test(e.textContent||\"\")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),o=[];let n=t.nextNode();for(;null!==n;)o.push(n),n=t.nextNode();o.forEach((e=>{const t=document.createDocumentFragment(),o=e.textContent||\"\";let n,r=0;for(l.lastIndex=0,n=l.exec(o);null!==n;){const e=n.index;r<e&&t.appendChild(document.createTextNode(o.slice(r,e)));const c=n[0],i=c.replace(/^https?:\\/\\//,\"//\").replace(/^www\\./,\"//\"),s=document.createElement(\"a\");s.href=i,s.target=\"_blank\",s.textContent=c,t.appendChild(s),r=e+c.length,n=l.exec(o)}r<o.length&&t.appendChild(document.createTextNode(o.slice(r))),e.parentNode?.replaceChild(t,e)}))})(),(()=>{const e=document.querySelector(\".desc-info-text\");if(!e)return;const t=Array.from(e.querySelectorAll(\"a\"));for(let e=0;e<t.length-1;e++){const o=t[e],r=t[e+1],c=o.getAttribute(\"href\")||\"\",i=r.textContent?.trim()||\"\",l=r.getAttribute(\"href\")||\"\";if(/^(https?:)?\\/\\/(www\\.)?nicovideo\\.jp\\/watch\\/?$/.test(c)&&/^sm\\d+$/.test(i)&&l.includes(`/watch/${i}`)){const t=l.replace(/^(https?:)?/,\"//\"),c=document.createElement(\"a\");c.href=t,c.target=\"_blank\",c.textContent=i,o.replaceWith(c),r.remove(),n.log(`Merged Nico link: ${i}`),e++}}})()}catch(e){n.error(\"处理链接时遇到 Error:\",e)}},d=()=>{n.log(\"视频链接增强已启用\"),s(),i&&i.disconnect(),i=new MutationObserver(s),i.observe(document.documentElement,{childList:!0,subtree:!0}),n.log(\"已设置 Observer\")},a=(0,e.defineComponentMetadata)({name:\"activeVideoLinks\",displayName:\"视频链接增强\",tags:[componentsTags.utils],entry:d,reload:d,unload:()=>{i&&(i.disconnect(),i=null)},urlInclude:o.videoUrls,author:{name:\"Alan Ye\",link:\"https://github.com/at-wr\"},commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\",description:(()=>{const e=r(642);return{...Object.fromEntries(e.keys().map((t=>[t.match(/index\\.(.+)\\.md$/)[1],e(t)]))),\"zh-CN\":()=>Promise.resolve().then(r.t.bind(r,401,17)).then((e=>e.default))}})()})})(),c=c.component})()));",
      "metadata": {
        "name": "activeVideoLinks",
        "displayName": "视频链接增强",
        "tags": [
          {
            "name": "utils",
            "displayName": "工具",
            "color": "#A36FFD",
            "icon": "mdi-rocket-launch-outline",
            "order": 5
          }
        ],
        "author": {
          "name": "Alan Ye",
          "link": "https://github.com/at-wr"
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1",
        "description": {}
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    },
    "downloadEmoticons": {
      "code": "!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports[\"utils/download-emoticons\"]=t():e[\"utils/download-emoticons\"]=t()}(globalThis,(()=>(()=>{var e,t,o={707:(e,t,o)=>{\"use strict\";o.r(t),o.d(t,{default:()=>p});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(\"DefaultWidget\",{attrs:{disabled:e.downloading,name:\"下载up主表情包\",icon:\"mdi-emoticon-outline\"},on:{click:function(t){return e.download()}}})};n._withStripped=!0;const r=coreApis.ui,i=coreApis.utils.log,a=coreApis.ajax;function s(e,t,o){return(t=function(e){var t=function(e,t){if(\"object\"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||\"default\");if(\"object\"!=typeof n)return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}(e,\"string\");return\"symbol\"==typeof t?t:t+\"\"}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const c=(0,i.useScopedConsole)(\"表情包下载\");const l=coreApis.download,d=coreApis.toast,u=new class{constructor(){s(this,\"apiRequest\",(e=>{const t={url:e,method:\"GET\",responseType:\"json\"};return(0,a.monkey)(t)})),s(this,\"getImageBlob\",(async e=>{const t={url:e,method:\"GET\",responseType:\"blob\"};return(0,a.monkey)(t)}))}async getEmoticonsByRoomId(e){return await this.apiRequest(`https://api.live.bilibili.com/xlive/web-ucenter/v2/emoticon/GetEmoticons?platform=pc&room_id=${e}`)}async downloadEmoticons(e){return e.map((e=>({emoticons:e.emoticons.map((e=>{try{const t=this.getImageBlob(e.url);return{emoji:e.emoji,blob:t}}catch(t){return c.error(`下载表情 ${e.emoji} 失败:`,t),null}})),pkg_name:e.pkg_name})))}async getEmoticonsArray(e){try{let t=await this.getEmoticonsByRoomId(e);if(0===t.data.data.length){c.log(\"获取表情包失败，尝试获取真实roomId\");const o=await this.getRealRoomId(e);t=await this.getEmoticonsByRoomId(o)}return t.data.data.slice(2)}catch(e){throw new Error(\"获取表情包失败\")}}async batchDownload(e){const t=[];for(const o of e){const e=(async()=>{const e=[],t=o.emoticons.map((e=>e.blob));for(const o of t){const t=await o;e.push(t)}return{pkg_name:o.pkg_name,emoticons:o.emoticons.map(((t,o)=>({emoji:t.emoji,blob:e[o]})))}})();t.push(e)}return Promise.all(t)}async getRealRoomId(e){try{const t=await this.apiRequest(`https://api.live.bilibili.com/room/v1/Room/get_info?room_id=${e}`);if(0===Object.keys(t.data).length)throw new Error(\"获取直播间id失败\");return t.data.room_id}catch(e){throw new Error(\"获取直播间id失败\")}}};var m=function(e,t,o,n,r,i,a,s){var c,l=\"function\"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=o,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId=\"data-v-\"+i),a?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=c):r&&(c=s?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:l}}(Vue.extend({components:{DefaultWidget:r.DefaultWidget},data:()=>({downloading:!1,midRegex:/mid=(\\d+)/,roomIdRegex:/^https:\\/\\/live\\.bilibili\\.com\\/(\\d+)(?:\\?.*)?$/}),methods:{async download(){this.downloading=!0;try{const e=window.location.href;if(e.startsWith(\"https://live.bilibili.com/\")){const t=this.roomIdRegex.exec(e)[1],o=await u.getEmoticonsArray(t);if(0===o.length)return void d.Toast.info(\"该up主没有专属表情包\",\"表情包下载\");const n=await u.downloadEmoticons(o),r=await u.batchDownload(n),i=new l.DownloadPackage;i.noEscape=!0;for(const e of r)if(null!==e)for(const t of e.emoticons)i.add(`${e.pkg_name}/${t.emoji}.png`,t.blob);await i.emit(`emoticons-${t}.zip`)}}catch(e){d.Toast.error(\"下载失败详情查看控制台\",\"表情包下载\"),(0,i.logError)(e)}finally{this.downloading=!1}}}}),n,[],!1,null,null,null);const p=m.exports},726:e=>{function t(e){var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}t.keys=()=>[],t.resolve=t,t.id=726,e.exports=t},701:e=>{\"use strict\";e.exports=\"## 下载up主专属表情包\\n\\n支持下载up主专属表情包，处于任意直播间页面时，下载按钮会在`功能`面板显示，以压缩包形式保存。\"}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return o[e](i,i.exports,r),i.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if(\"object\"==typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&\"function\"==typeof o.then)return o}var i=Object.create(null);r.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&o;\"object\"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>o[e]));return a.default=()=>o,r.d(i,a),i},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};return(()=>{\"use strict\";r.d(i,{component:()=>e});const e=(0,coreApis.componentApis.define.defineComponentMetadata)({name:\"downloadEmoticons\",displayName:\"下载表情\",tags:[componentsTags.utils,componentsTags.live],entry:none,author:{name:\"Pencilqaq\",link:\"https://github.com/pencilqaq\"},widget:{component:()=>Promise.resolve().then(r.bind(r,707)).then((e=>e.default))},urlInclude:[/^https:\\/\\/live\\.bilibili\\.com\\/(\\d+)/],commitHash:\"68de95a83dde1f4a399e548b7dcfa85b7d5becd9\",coreVersion:\"2.10.1\",description:(()=>{const e=r(726);return{...Object.fromEntries(e.keys().map((t=>[t.match(/index\\.(.+)\\.md$/)[1],e(t)]))),\"zh-CN\":()=>Promise.resolve().then(r.t.bind(r,701,17)).then((e=>e.default))}})()})})(),i=i.component})()));",
      "metadata": {
        "name": "downloadEmoticons",
        "displayName": "下载表情",
        "tags": [
          {
            "name": "utils",
            "displayName": "工具",
            "color": "#A36FFD",
            "icon": "mdi-rocket-launch-outline",
            "order": 5
          },
          {
            "name": "live",
            "displayName": "直播",
            "color": "#26A69A",
            "icon": "mdi-video-wireless-outline",
            "order": 4
          }
        ],
        "author": {
          "name": "Pencilqaq",
          "link": "https://github.com/pencilqaq"
        },
        "commitHash": "68de95a83dde1f4a399e548b7dcfa85b7d5becd9",
        "coreVersion": "2.10.1",
        "description": {}
      },
      "settings": {
        "enabled": true,
        "options": {}
      }
    }
  },
  "components": {
    "settingsPanel": {
      "enabled": true,
      "options": {
        "themeColor": "#00A0D8",
        "scriptLoadingMode": "同时",
        "styleLoadingMode": "同时",
        "textColor": "自动",
        "cdnRoot": "GitHub",
        "dockSide": "左侧",
        "filenameFormat": "[title][ - ep]",
        "batchFilenameFormat": "[n - ][ep]",
        "downloadPackageEmitMode": "打包下载",
        "devMode": false
      }
    },
    "launchBar": {
      "enabled": true,
      "options": {}
    },
    "i18n": {
      "enabled": true,
      "options": {
        "language": "简体中文",
        "translator": "GoogleCN"
      }
    },
    "autoUpdate": {
      "enabled": false,
      "options": {
        "lastUpdateCheck": 1747315170379,
        "lastInstalledVersion": "2.10.1",
        "localPortOverride": "",
        "minimumDuration": 86400000,
        "urls": {
          "components": {
            "badgeHelper": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/live/badge-helper.js",
              "lastUpdateCheck": 1747315164834,
              "installTime": 1671346834515,
              "alwaysUpdate": false
            },
            "autoHideSidebar": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/style/auto-hide-sidebar.js",
              "lastUpdateCheck": 1747315165277,
              "installTime": 1671346839232,
              "alwaysUpdate": false
            },
            "downloadAudio": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/utils/download-audio.js",
              "lastUpdateCheck": 1747315165706,
              "installTime": 1671346848665,
              "alwaysUpdate": false
            },
            "viewCover": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/utils/view-cover.js",
              "lastUpdateCheck": 1747315166161,
              "installTime": 1671346853355,
              "alwaysUpdate": false
            },
            "downloadDanmaku": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/danmaku/download.js",
              "lastUpdateCheck": 1747315166628,
              "installTime": 1671346857787,
              "alwaysUpdate": false
            },
            "downloadVideo": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/download.js",
              "lastUpdateCheck": 1747315167072,
              "installTime": 1671346862162,
              "alwaysUpdate": false
            },
            "videoScreenshot": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/player/screenshot.js",
              "lastUpdateCheck": 1747315167535,
              "installTime": 1671346866921,
              "alwaysUpdate": false
            },
            "seekByFrames": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/player/seek-by-frames.js",
              "lastUpdateCheck": 1747315167993,
              "installTime": 1671346871434,
              "alwaysUpdate": false
            },
            "seoRedirect": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/seo-redirect.js",
              "lastUpdateCheck": 1747315168469,
              "installTime": 1671346875753,
              "alwaysUpdate": false
            },
            "downloadSubtitle": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/video/subtitle/download.js",
              "lastUpdateCheck": 1747315168933,
              "installTime": 1671346879042,
              "alwaysUpdate": false
            },
            "hide-fullscreen-gift-bar": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/preview/registry/dist/components/live/hide-gift-fullscreen.js",
              "lastUpdateCheck": 1747315169391,
              "installTime": 1733552548771,
              "alwaysUpdate": false
            },
            "activeVideoLinks": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/refs/heads/preview/registry/dist/components/utils/active-video-links.js",
              "lastUpdateCheck": 1747315169873,
              "installTime": 1744197180625,
              "alwaysUpdate": false
            },
            "downloadEmoticons": {
              "url": "https://raw.githubusercontent.com/the1812/Bilibili-Evolved/refs/heads/preview/registry/dist/components/utils/download-emoticons.js",
              "lastUpdateCheck": 1747315170379,
              "installTime": 1744197186324,
              "alwaysUpdate": false
            }
          },
          "plugins": {},
          "styles": {}
        },
        "maxUpdateCount": 4
      }
    },
    "notifyNewVersion": {
      "enabled": false,
      "options": {
        "lastUpdateCheck": 0,
        "minimumDuration": 86400000
      }
    },
    "bisector": {
      "enabled": true,
      "options": {
        "originalComponentEnableState": {},
        "keepDisabledComponents": [],
        "keepEnabledComponents": [],
        "bisectInitialState": {}
      }
    },
    "compatibilities": {
      "enabled": true,
      "options": {
        "disableOnBalh": false
      }
    }
  },
  "plugins": {
    "ajaxHook": true,
    "launchBar.actions.IDSearch": true
  }
}